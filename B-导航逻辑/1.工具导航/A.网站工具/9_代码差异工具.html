<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£ç å·®å¼‚å¯¹æ¯”å·¥å…·</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/lucide@latest/dist/umd/lucide.js">
    <style>
        /* åŸºç¡€æ ·å¼é‡ç½®å’Œå…¨å±€å˜é‡ */
        :root {
            /* ä¸»è‰²è°ƒ */
            --primary-500: #007AFF;
            --primary-300: #52A6FF;
            --primary-100: #B9DDFF;
            
            /* ä¸­æ€§è‰² */
            --page-bg: #0A0A0A;
            --surface-glass: rgba(28, 28, 30, 0.5);
            --border-default: rgba(255, 255, 255, 0.1);
            --border-hover: rgba(255, 255, 255, 0.2);
            --text-primary: #E4E4E7;
            --text-secondary: #A1A1AA;
            
            /* è¯­ä¹‰è‰² */
            --diff-add: #22C55E;
            --diff-remove: #EF4444;
            --diff-add-char: #A3E635;
            --diff-remove-char: #F87171;
            
            /* é—´è· */
            --space-xs: 8px;
            --space-sm: 16px;
            --space-md: 24px;
            --space-lg: 32px;
            --space-xl: 48px;
            --space-xxl: 96px;
            
            /* åœ†è§’ */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-full: 999px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #0A0A0A 0%, #1a1a1a 100%);
            background-attachment: fixed;
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* é¡µé¢è·¯ç”± */
        .page {
            display: none;
            min-height: 100vh;
            padding: var(--space-md) var(--space-md) var(--space-xl);
            animation: fadeIn 0.3s ease-out;
        }

        .page.active {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding-top: var(--space-xxl);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            width: 100%;
            max-width: 1440px;
            display: flex;
            flex-direction: column;
            gap: var(--space-xl);
        }

        /* æ ‡é¢˜åŒºåŸŸ */
        .header {
            text-align: center;
            margin-bottom: var(--space-lg);
            margin-top: var(--space-sm);
        }

        .title {
            font-size: 48px;
            font-weight: 700;
            line-height: 1.2;
            background: linear-gradient(135deg, var(--primary-500), var(--primary-300));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
        }

        .subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* ä»£ç è¾“å…¥åŒºåŸŸ */
        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-lg);
            width: 100%;
        }

        .code-card {
            background: var(--surface-glass);
            backdrop-filter: blur(24px);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            display: flex;
            flex-direction: column;
            transition: border-color 250ms ease-out, box-shadow 250ms ease-out;
        }

        .code-card:hover {
            border-color: var(--border-hover);
        }

        .code-card:focus-within {
            border-color: var(--primary-500);
            box-shadow: 0 0 16px rgba(0, 122, 255, 0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
        }

        .card-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .file-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            background: var(--border-default);
            padding: 4px 8px;
            border-radius: var(--radius-sm);
        }

        .card-actions {
            display: flex;
            gap: var(--space-xs);
        }

        .copy-btn {
            background: transparent;
            border: 1px solid var(--border-default);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 200ms ease;
            display: flex;
            align-items: center;
            gap: 4px;
            min-height: 32px;
        }

        .copy-btn:hover {
            border-color: var(--primary-500);
            color: var(--primary-500);
            transform: translateY(-1px);
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .copy-btn.copied {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }

        .code-textarea {
            width: 100%;
            flex-grow: 1;
            background: transparent;
            border: none;
            outline: none;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
            transition: background-color 200ms ease;
        }

        .code-textarea:focus {
            background: rgba(255, 255, 255, 0.02);
        }

        .code-textarea::placeholder {
            color: var(--text-secondary);
        }

        /* æ“ä½œæŒ‰é’®åŒºåŸŸ */
        .action-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-md);
            width: 100%;
        }

        .action-buttons {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
            justify-content: center;
        }

        .generate-button {
            padding: var(--space-sm) var(--space-xl);
            background: linear-gradient(135deg, var(--primary-500), var(--primary-300));
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 200ms cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 16px rgba(0, 122, 255, 0.2);
            min-width: 240px;
            height: 56px;
        }

        .generate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 24px rgba(0, 122, 255, 0.4);
        }

        .generate-button:active {
            transform: scale(0.98);
        }

        .clear-button {
            padding: var(--space-sm) var(--space-xl);
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 200ms cubic-bezier(0.25, 0.8, 0.25, 1);
            min-width: 120px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .clear-button:hover {
            border-color: var(--text-secondary);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .secondary-button {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--diff-remove);
            color: var(--diff-remove);
        }

        .secondary-button:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--diff-remove);
            color: var(--diff-remove);
        }

        /* æŠ¥å‘Šé¡µé¢ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding: 0 var(--space-md);
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        .report-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
            text-align: center;
        }

        .zoom-controls {
            display: flex;
            gap: var(--space-xs);
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .title { font-size: 36px; }
            .input-section { gap: var(--space-md); }
            .code-card { padding: var(--space-md); }
        }

        @media (max-width: 768px) {
            .page { 
                padding: var(--space-sm) var(--space-sm) var(--space-lg);
                padding-top: var(--space-lg);
            }
            .page.active {
                padding-top: var(--space-lg);
            }
            .container { gap: var(--space-lg); }
            .input-section { 
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            .title { font-size: 24px; }
            .subtitle { font-size: 14px; }
            .card-title { font-size: 18px; }
            .card-actions { 
                flex-direction: column;
                gap: 4px;
            }
            .copy-btn {
                font-size: 11px;
                padding: 4px 8px;
            }
            .generate-button { 
                min-width: 180px; 
                height: 48px;
                font-size: 14px;
            }
            .action-buttons {
                flex-direction: column;
                width: 100%;
                max-width: 280px;
            }
            .clear-button {
                width: 100%;
                min-width: unset;
            }
            .report-header {
                flex-direction: column;
                align-items: stretch;
                gap: var(--space-sm);
            }
            .report-title {
                order: -1;
                font-size: 18px;
            }
            .zoom-controls {
                justify-content: center;
            }
            .zoom-btn {
                width: 44px;
                height: 44px;
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .page { 
                padding: var(--space-xs) var(--space-xs) var(--space-md);
                padding-top: var(--space-md);
            }
            .page.active {
                padding-top: var(--space-md);
            }
            .code-card { padding: var(--space-sm); }
            .generate-button {
                min-width: 160px;
                font-size: 13px;
            }
            .card-title { font-size: 16px; }
            .header {
                margin-top: 0;
                margin-bottom: var(--space-md);
            }
        }

        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--surface-glass);
            color: var(--text-primary);
            padding: var(--space-xs);
            border-radius: var(--radius-sm);
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 200ms ease;
            margin-bottom: var(--space-xs);
            border: 1px solid var(--border-default);
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <!-- ä¸»è¾“å…¥é¡µé¢ -->
    <div id="main-page" class="page active">
        <div class="container">
            <div class="header">
                <h1 class="title">è®ºæ–‡/ä»£ç å·®å¼‚å¯¹æ¯”å·¥å…·</h1>
                <p class="subtitle">ä¸“ä¸šçº§ä»£ç å·®å¼‚åˆ†æï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€</p>
            </div>

            <div class="input-section">
                <div class="code-card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">
                                <span>ğŸ“„</span>
                                æ–‡ä»¶A
                            </h2>
                            <span class="file-label">åŸå§‹ç‰ˆæœ¬</span>
                        </div>
                        <div class="card-actions">
                            <button class="copy-btn" data-target="fileA">
                                ğŸ“‹ å¤åˆ¶
                            </button>
                        </div>
                    </div>
                    <textarea 
                        id="fileA" 
                        class="code-textarea" 
                        placeholder="åœ¨æ­¤ç²˜è´´æ‚¨çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ä»£ç ..."
                    ></textarea>
                </div>

                <div class="code-card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">
                                <span>ğŸ“„</span>
                                æ–‡ä»¶B
                            </h2>
                            <span class="file-label">ä¿®æ”¹ç‰ˆæœ¬</span>
                        </div>
                        <div class="card-actions">
                            <button class="copy-btn" data-target="fileB">
                                ğŸ“‹ å¤åˆ¶
                            </button>
                        </div>
                    </div>
                    <textarea 
                        id="fileB" 
                        class="code-textarea" 
                        placeholder="åœ¨æ­¤ç²˜è´´æ‚¨çš„ç¬¬äºŒä¸ªæ–‡ä»¶ä»£ç ..."
                    ></textarea>
                </div>
            </div>

            <div class="action-section">
                <button id="generate-btn" class="generate-button">
                    âš¡ ç”Ÿæˆå·®å¼‚æŠ¥å‘Š
                </button>
                
                <div class="action-buttons">
                    <button id="clear-btn" class="clear-button secondary-button tooltip" data-tooltip="æ¸…ç©ºä¸¤ä¸ªè¾“å…¥æ¡†">
                        ğŸ—‘ï¸ æ¸…ç©ºå†…å®¹
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- å·®å¼‚æŠ¥å‘Šé¡µé¢ -->
    <div id="report-page" class="page">
        <div class="container" style="max-width: none; width: 100%; height: 100vh;">
            <!-- æŠ¥å‘Šé¡µé¢å¤´éƒ¨ -->
            <div class="report-header">
                <button id="back-btn" class="clear-button" style="display: flex; align-items: center; gap: 8px;">
                    â† è¿”å›ç¼–è¾‘
                </button>
                
                <h1 class="report-title">
                    ğŸ” å·®å¼‚åˆ†ææŠ¥å‘Š
                </h1>
                
                <div class="zoom-controls">
                    <button id="zoom-out-btn" class="clear-button zoom-btn" data-tooltip="ç¼©å°">
                        ğŸ”-
                    </button>
                    <button id="zoom-reset-btn" class="clear-button zoom-btn" data-tooltip="é‡ç½®ç¼©æ”¾">
                        ğŸ¯
                    </button>
                    <button id="zoom-in-btn" class="clear-button zoom-btn" data-tooltip="æ”¾å¤§">
                        ğŸ”+
                    </button>
                </div>
            </div>

            <!-- å·®å¼‚å¯¹æ¯”å†…å®¹åŒºåŸŸ -->
            <div id="diff-content" style="flex-grow: 1; background: var(--surface-glass); backdrop-filter: blur(24px); border: 1px solid var(--border-default); border-radius: var(--radius-md); padding: var(--space-lg); overflow: auto; font-family: 'JetBrains Mono', monospace; font-size: 14px; line-height: 1.6;">
                <!-- å·®å¼‚å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // é¢„ç½®ç¤ºä¾‹ä»£ç 
        const sampleCodeA = `// æ–‡ä»¶A - åŸå§‹ç‰ˆæœ¬
function calculateSum(numbers) {
    let total = 0;
    for (let i = 0; i < numbers.length; i++) {
        total += numbers[i];
    }
    return total;
}

function greet(name) {
    return "Hello, " + name;
}

const users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 },
    { name: "Charlie", age: 35 }
];

console.log(greet("World"));
console.log("Total:", calculateSum([1, 2, 3, 4, 5]));`;

        const sampleCodeB = `// æ–‡ä»¶B - ä¿®æ”¹ç‰ˆæœ¬
function calculateSum(numbers) {
    // ä½¿ç”¨reduceæ–¹æ³•ä¼˜åŒ–æ€§èƒ½
    return numbers.reduce((total, num) => total + num, 0);
}

function greet(name, formal = false) {
    return formal ? "Good day, " + name : "Hello, " + name;
}

function calculateAverage(numbers) {
    const sum = calculateSum(numbers);
    return sum / numbers.length;
}

const users = [
    { name: "Alice", age: 25, email: "alice@example.com" },
    { name: "Bob", age: 30, email: "bob@example.com" },
    { name: "Charlie", age: 35, email: "charlie@example.com" }
];

console.log(greet("World"));
console.log("Total:", calculateSum([1, 2, 3, 4, 5]));
console.log("Average:", calculateAverage([1, 2, 3, 4, 5]));`;

        // DOM å…ƒç´ 
        const fileA = document.getElementById('fileA');
        const fileB = document.getElementById('fileB');
        const generateBtn = document.getElementById('generate-btn');
        const clearBtn = document.getElementById('clear-btn');
        const backBtn = document.getElementById('back-btn');
        const mainPage = document.getElementById('main-page');
        const reportPage = document.getElementById('report-page');
        const diffContent = document.getElementById('diff-content');

        // ç¼©æ”¾æ§åˆ¶
        let currentZoom = 100;
        const zoomInBtn = document.getElementById('zoom-in-btn');
        const zoomOutBtn = document.getElementById('zoom-out-btn');
        const zoomResetBtn = document.getElementById('zoom-reset-btn');

        // é¡µé¢è·¯ç”±
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // å¤åˆ¶åŠŸèƒ½
        function copyToClipboard(text) {
            if (navigator.clipboard && window.isSecureContext) {
                // ä½¿ç”¨ç°ä»£ API
                return navigator.clipboard.writeText(text);
            } else {
                // åå¤‡æ–¹æ¡ˆ
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                return new Promise((resolve, reject) => {
                    if (document.execCommand('copy')) {
                        resolve();
                    } else {
                        reject();
                    }
                    document.body.removeChild(textArea);
                });
            }
        }

        // å¤åˆ¶æŒ‰é’®äº‹ä»¶
        function setupCopyButtons() {
            const copyBtns = document.querySelectorAll('.copy-btn');
            
            copyBtns.forEach(btn => {
                btn.addEventListener('click', async () => {
                    const targetId = btn.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);
                    const text = targetElement.value;
                    
                    if (!text.trim()) {
                        btn.textContent = 'âš ï¸ æ— å†…å®¹';
                        btn.style.color = 'var(--diff-remove)';
                        setTimeout(() => {
                            btn.textContent = 'ğŸ“‹ å¤åˆ¶';
                            btn.style.color = '';
                        }, 1500);
                        return;
                    }
                    
                    try {
                        await copyToClipboard(text);
                        btn.classList.add('copied');
                        btn.textContent = 'âœ… å·²å¤åˆ¶';
                        
                        setTimeout(() => {
                            btn.classList.remove('copied');
                            btn.textContent = 'ğŸ“‹ å¤åˆ¶';
                        }, 2000);
                    } catch (err) {
                        btn.textContent = 'âŒ å¤±è´¥';
                        btn.style.color = 'var(--diff-remove)';
                        setTimeout(() => {
                            btn.textContent = 'ğŸ“‹ å¤åˆ¶';
                            btn.style.color = '';
                        }, 2000);
                    }
                });
            });
        }

        // åˆå§‹åŒ–æ—¶åŠ è½½ç¤ºä¾‹ä»£ç 
        function loadSamples() {
            fileA.value = sampleCodeA;
            fileB.value = sampleCodeB;
        }

        // æ¸…ç©ºå†…å®¹
        function clearContent() {
            fileA.value = '';
            fileB.value = '';
        }

        // ç®€å•çš„å·®å¼‚æ£€æµ‹ç®—æ³•ï¼ˆè¡Œçº§åˆ«ï¼‰
        function detectDifferences(textA, textB) {
            const linesA = textA.split('\n');
            const linesB = textB.split('\n');
            const maxLines = Math.max(linesA.length, linesB.length);
            const diffs = [];

            for (let i = 0; i < maxLines; i++) {
                const lineA = linesA[i] || '';
                const lineB = linesB[i] || '';
                
                if (lineA === lineB) {
                    // ç›¸åŒè¡Œ
                    diffs.push({ type: 'equal', lineA: i + 1, lineB: i + 1, content: lineA });
                } else if (lineA && !lineB) {
                    // åˆ é™¤çš„è¡Œ
                    diffs.push({ type: 'removed', lineA: i + 1, lineB: '', content: lineA });
                } else if (!lineA && lineB) {
                    // æ–°å¢çš„è¡Œ
                    diffs.push({ type: 'added', lineA: '', lineB: i + 1, content: lineB });
                } else {
                    // ä¿®æ”¹çš„è¡Œ
                    diffs.push({ 
                        type: 'changed', 
                        lineA: i + 1, 
                        lineB: i + 1, 
                        contentA: lineA, 
                        contentB: lineB 
                    });
                }
            }

            return diffs;
        }

        // ç”Ÿæˆå·®å¼‚æŠ¥å‘Š
        function generateDiffReport() {
            const contentA = fileA.value.trim();
            const contentB = fileB.value.trim();

            if (!contentA && !contentB) {
                alert('è¯·è¾“å…¥è¦å¯¹æ¯”çš„ä»£ç å†…å®¹');
                return;
            }

            const diffs = detectDifferences(contentA, contentB);
            
            // ç”ŸæˆHTML
            let html = '';
            
            // ç»Ÿè®¡ä¿¡æ¯
            const stats = {
                total: diffs.length,
                added: diffs.filter(d => d.type === 'added').length,
                removed: diffs.filter(d => d.type === 'removed').length,
                changed: diffs.filter(d => d.type === 'changed').length,
                equal: diffs.filter(d => d.type === 'equal').length
            };

            html += `<div style="margin-bottom: 32px; padding: 16px; background: var(--surface-glass); border-radius: 8px; border: 1px solid var(--border-default);">
                <h3 style="margin: 0 0 16px 0; color: var(--text-primary); font-size: 16px;">ğŸ“Š å·®å¼‚ç»Ÿè®¡</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--text-primary);">${stats.total}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">æ€»è¡Œæ•°</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--diff-add);">+${stats.added}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">æ–°å¢</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--diff-remove);">-${stats.removed}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">åˆ é™¤</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary-500);">~${stats.changed}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">ä¿®æ”¹</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--text-secondary);">${stats.equal}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">ç›¸åŒ</div>
                    </div>
                </div>
            </div>`;

            // å·®å¼‚è¯¦ç»†åˆ—è¡¨ - ç§»åŠ¨ç«¯ä¼˜åŒ–
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                // ç§»åŠ¨ç«¯ï¼šç»Ÿä¸€è§†å›¾ï¼Œæ‰€æœ‰è¡Œæ˜¾ç¤ºåœ¨ä¸€åˆ—
                html += '<div style="display: flex; flex-direction: column; gap: 8px; font-family: monospace;">';
                
                diffs.forEach((diff, index) => {
                    if (diff.type === 'equal') {
                        html += `<div style="padding: 6px 12px; border-radius: 4px; opacity: 0.6; border-left: 3px solid var(--border-default);">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="color: var(--text-secondary); font-size: 12px;">${diff.lineA}</span>
                                <span style="color: var(--text-secondary); font-size: 12px;">${diff.lineB}</span>
                            </div>
                            <div style="color: var(--text-secondary); font-size: 13px; line-height: 1.4;">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'added') {
                        html += `<div style="padding: 6px 12px; border-radius: 4px; background: rgba(34, 197, 94, 0.1); border-left: 3px solid var(--diff-add);">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="color: var(--diff-add); font-size: 12px; font-weight: 600;">+ ${diff.lineB}</span>
                                <span style="background: var(--diff-add); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">æ–°å¢</span>
                            </div>
                            <div style="color: var(--diff-add); font-size: 13px; line-height: 1.4;">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'removed') {
                        html += `<div style="padding: 6px 12px; border-radius: 4px; background: rgba(239, 68, 68, 0.1); border-left: 3px solid var(--diff-remove);">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="color: var(--diff-remove); font-size: 12px; font-weight: 600;">- ${diff.lineA}</span>
                                <span style="background: var(--diff-remove); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">åˆ é™¤</span>
                            </div>
                            <div style="color: var(--diff-remove); font-size: 13px; line-height: 1.4;">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'changed') {
                        // ä¿®æ”¹çš„è¡Œéœ€è¦å¯¹æ¯”å­—ç¬¦çº§å·®å¼‚
                        const commonPrefix = findCommonPrefix(diff.contentA, diff.contentB);
                        const commonSuffix = findCommonSuffix(diff.contentA, diff.contentB, commonPrefix);
                        
                        const oldBefore = diff.contentA.substring(0, commonPrefix);
                        const oldChanged = diff.contentA.substring(commonPrefix, diff.contentA.length - commonSuffix);
                        const oldAfter = diff.contentA.substring(diff.contentA.length - commonSuffix);
                        
                        const newBefore = diff.contentB.substring(0, commonPrefix);
                        const newChanged = diff.contentB.substring(commonPrefix, diff.contentB.length - commonSuffix);
                        const newAfter = diff.contentB.substring(diff.contentB.length - commonSuffix);

                        // æ—§ç‰ˆæœ¬
                        html += `<div style="padding: 6px 12px; border-radius: 4px; background: rgba(239, 68, 68, 0.05); border-left: 3px solid var(--diff-remove); margin-bottom: 4px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="color: var(--diff-remove); font-size: 12px; font-weight: 600;">${diff.lineA}</span>
                                <span style="background: var(--diff-remove); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">åŸç‰ˆ</span>
                            </div>
                            <div style="color: var(--text-primary); font-size: 13px; line-height: 1.4;">
                                <span style="color: var(--text-secondary);">${oldBefore}</span>
                                <span style="background: rgba(239, 68, 68, 0.3); padding: 2px 4px; border-radius: 2px;">${oldChanged}</span>
                                <span style="color: var(--text-secondary);">${oldAfter}</span>
                            </div>
                        </div>`;

                        // æ–°ç‰ˆæœ¬
                        html += `<div style="padding: 6px 12px; border-radius: 4px; background: rgba(34, 197, 94, 0.05); border-left: 3px solid var(--diff-add);">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="color: var(--diff-add); font-size: 12px; font-weight: 600;">${diff.lineB}</span>
                                <span style="background: var(--diff-add); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">æ–°ç‰ˆ</span>
                            </div>
                            <div style="color: var(--text-primary); font-size: 13px; line-height: 1.4;">
                                <span style="color: var(--text-secondary);">${newBefore}</span>
                                <span style="background: rgba(34, 197, 94, 0.3); padding: 2px 4px; border-radius: 2px;">${newChanged}</span>
                                <span style="color: var(--text-secondary);">${newAfter}</span>
                            </div>
                        </div>`;
                    }
                });

                html += '</div>';
            } else {
                // æ¡Œé¢ç«¯ï¼šå·¦å³åˆ†æ è§†å›¾
                html += '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; font-family: monospace;">';
                
                diffs.forEach((diff, index) => {
                    if (diff.type === 'equal') {
                        html += `<div style="grid-column: span 2; display: grid; grid-template-columns: 60px 60px 1fr; gap: 8px; padding: 4px 8px; border-radius: 4px; opacity: 0.6;">
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">${diff.lineA}</div>
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">${diff.lineB}</div>
                            <div style="color: var(--text-secondary);">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'added') {
                        html += `<div style="grid-column: span 2; display: grid; grid-template-columns: 60px 60px 1fr; gap: 8px; padding: 4px 8px; border-radius: 4px; background: rgba(34, 197, 94, 0.1); border-left: 3px solid var(--diff-add);">
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">-</div>
                            <div style="text-align: right; color: var(--diff-add); font-size: 12px; font-weight: 600;">${diff.lineB}</div>
                            <div style="color: var(--diff-add);">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'removed') {
                        html += `<div style="grid-column: span 2; display: grid; grid-template-columns: 60px 60px 1fr; gap: 8px; padding: 4px 8px; border-radius: 4px; background: rgba(239, 68, 68, 0.1); border-left: 3px solid var(--diff-remove);">
                            <div style="text-align: right; color: var(--diff-remove); font-size: 12px; font-weight: 600;">${diff.lineA}</div>
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">-</div>
                            <div style="color: var(--diff-remove);">${diff.content}</div>
                        </div>`;
                    } else if (diff.type === 'changed') {
                        // ä¿®æ”¹çš„è¡Œéœ€è¦å¯¹æ¯”å­—ç¬¦çº§å·®å¼‚
                        const commonPrefix = findCommonPrefix(diff.contentA, diff.contentB);
                        const commonSuffix = findCommonSuffix(diff.contentA, diff.contentB, commonPrefix);
                        
                        const oldBefore = diff.contentA.substring(0, commonPrefix);
                        const oldChanged = diff.contentA.substring(commonPrefix, diff.contentA.length - commonSuffix);
                        const oldAfter = diff.contentA.substring(diff.contentA.length - commonSuffix);
                        
                        const newBefore = diff.contentB.substring(0, commonPrefix);
                        const newChanged = diff.contentB.substring(commonPrefix, diff.contentB.length - commonSuffix);
                        const newAfter = diff.contentB.substring(diff.contentB.length - commonSuffix);

                        // æ—§ç‰ˆæœ¬
                        html += `<div style="display: grid; grid-template-columns: 60px 60px 1fr; gap: 8px; padding: 4px 8px; border-radius: 4px; background: rgba(239, 68, 68, 0.05);">
                            <div style="text-align: right; color: var(--diff-remove); font-size: 12px; font-weight: 600;">${diff.lineA}</div>
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">-</div>
                            <div style="color: var(--text-primary);">
                                <span style="color: var(--text-secondary);">${oldBefore}</span>
                                <span style="background: rgba(239, 68, 68, 0.3); padding: 2px 4px; border-radius: 2px;">${oldChanged}</span>
                                <span style="color: var(--text-secondary);">${oldAfter}</span>
                            </div>
                        </div>`;

                        // æ–°ç‰ˆæœ¬
                        html += `<div style="display: grid; grid-template-columns: 60px 60px 1fr; gap: 8px; padding: 4px 8px; border-radius: 4px; background: rgba(34, 197, 94, 0.05);">
                            <div style="text-align: right; color: var(--text-secondary); font-size: 12px;">-</div>
                            <div style="text-align: right; color: var(--diff-add); font-size: 12px; font-weight: 600;">${diff.lineB}</div>
                            <div style="color: var(--text-primary);">
                                <span style="color: var(--text-secondary);">${newBefore}</span>
                                <span style="background: rgba(34, 197, 94, 0.3); padding: 2px 4px; border-radius: 2px;">${newChanged}</span>
                                <span style="color: var(--text-secondary);">${newAfter}</span>
                            </div>
                        </div>`;
                    }
                });

                html += '</div>';
            }
            
            diffContent.innerHTML = html;
            showPage('report-page');
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€
        function findCommonPrefix(str1, str2) {
            let i = 0;
            while (i < str1.length && i < str2.length && str1[i] === str2[i]) {
                i++;
            }
            return i;
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å…¬å…±åç¼€
        function findCommonSuffix(str1, str2, startIndex) {
            let i = 0;
            while (i < str1.length - startIndex && i < str2.length - startIndex && 
                   str1[str1.length - 1 - i] === str2[str2.length - 1 - i]) {
                i++;
            }
            return i;
        }

        // ç¼©æ”¾æ§åˆ¶
        function updateZoom() {
            diffContent.style.transform = `scale(${currentZoom / 100})`;
            diffContent.style.transformOrigin = 'top left';
        }

        // äº‹ä»¶ç›‘å¬å™¨
        generateBtn.addEventListener('click', generateDiffReport);
        clearBtn.addEventListener('click', clearContent);
        backBtn.addEventListener('click', () => showPage('main-page'));

        // ç¼©æ”¾æ§åˆ¶äº‹ä»¶
        zoomInBtn.addEventListener('click', () => {
            if (currentZoom < 200) {
                currentZoom += 25;
                updateZoom();
            }
        });

        zoomOutBtn.addEventListener('click', () => {
            if (currentZoom > 50) {
                currentZoom -= 25;
                updateZoom();
            }
        });

        zoomResetBtn.addEventListener('click', () => {
            currentZoom = 100;
            updateZoom();
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadSamples();
            setupCopyButtons();
            updateZoom();
        });

        // é‡æ–°è®¾ç½®å¤åˆ¶æŒ‰é’®ï¼ˆå½“é¡µé¢é‡æ–°åŠ è½½æ—¶ï¼‰
        window.addEventListener('load', () => {
            setupCopyButtons();
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (reportPage.classList.contains('active')) {
                        showPage('main-page');
                    } else {
                        generateDiffReport();
                    }
                }
            }
        });
    </script>
</body>
</html>