<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Termux Pythonåº“å®‰è£…è„šæœ¬</title>
    
        <!-- prism.js è¯­æ³•é«˜äº®   -->
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/1.prism-css-ç™½è‰²ä¸»é¢˜.js"></script>   
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-core.min.js"></script>    <!-- æ ¸å¿ƒæ–‡ä»¶ -->
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-bash.min.js"></script>   <!-- Bashè¯­è¨€æ”¯æŒ -->   
    
     <!-- å¼•å…¥ç¼©æ”¾æ’ä»¶ -->
    <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶å·¥å…·/3.æ’ä»¶_å­—ä½“ç¼©æ”¾.js"></script>
    
    <style>
        /* 1. åŸºç¡€æ ·å¼é‡ç½® */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* 2. é¡µé¢ä¸»ä½“æ ·å¼ - æŸ”å’ŒèƒŒæ™¯ä¸çº¹ç† */
        body { 
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace; 
            /* æŸ”å’Œçš„ç»¿è‰²æ¸å˜èƒŒæ™¯ + ç®€æ´çš„æ–œçº¿çº¹ç† */
            background: 
                repeating-linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 0.03),
                    rgba(255, 255, 255, 0.03) 10px,
                    transparent 10px,
                    transparent 20px
                ),
                repeating-linear-gradient(
                    -45deg,
                    rgba(255, 255, 255, 0.02),
                    rgba(255, 255, 255, 0.02) 10px,
                    transparent 10px,
                    transparent 20px
                ),
                linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 25%, #a5d6a7 50%, #81c784 75%, #66bb6a 100%);
            color: #2c3e50; 
            line-height: 1.6; 
            padding: 20px; 
            min-height: 100vh;
        }
        
        /* 3. ä¸»å®¹å™¨ */
        .container { max-width: 1200px; margin: 0 auto; animation: fadeIn 0.5s ease-in; }
        
        /* 4. é¡µé¢æ ‡é¢˜ */
        h3 { color: #2e7d32; margin-bottom: 30px; font-size: 28px; display: flex; align-items: center; gap: 12px; text-shadow: 0 2px 4px rgba(46, 125, 50, 0.2); animation: slideDown 0.6s ease-out; }
        
        /* 5. ä»£ç å—å®¹å™¨ */
        .code-container { background: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1); border: 1px solid #e1e8ed; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        
        /* 6. ä»£ç å—æ‚¬åœæ•ˆæœ */
        .code-container:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15); }
        
        /* 7. ä»£ç å¤´éƒ¨ */
        .code-header { background: linear-gradient(90deg, #f8f9fa 0%, #e9ecef 100%); padding: 15px 20px; border-bottom: 1px solid #dee2e6; display: flex; justify-content: space-between; align-items: center; }
        
        /* 8. ä»£ç æ ‡é¢˜ */
        .code-title { color: #6c757d; font-size: 14px; font-weight: 600; letter-spacing: 0.5px; }
        
        /* 9. å¤åˆ¶æŒ‰é’® */
        .copy-btn { background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 6px; box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3); }
        
        /* 10. å¤åˆ¶æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .copy-btn:hover { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); transform: scale(1.05); box-shadow: 0 4px 8px rgba(39, 174, 96, 0.4); }
        
        /* 11. å¤åˆ¶æŒ‰é’®å·²å¤åˆ¶çŠ¶æ€ */
        .copy-btn.copied { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
        
        /* 12. ä»£ç å†…å®¹åŒº */
        pre { background: #f8f9fa; padding: 20px; overflow-x: auto; font-size: 13px; line-height: 1.5; border-radius: 0 0 12px 12px; margin: 0; }
        
        /* 13. ä»£ç æ ‡ç­¾ */
        code { color: #495057; font-family: inherit; white-space: pre; }
        
        /* 14. åº•éƒ¨ä¿¡æ¯åŒº - æ›´ç´§å‡‘ */
        .info-section { margin-top: 20px; padding: 15px; background: rgba(255, 255, 255, 0.9); border-radius: 12px; backdrop-filter: blur(10px); border: 1px solid #e1e8ed; }
        
        /* 15. ä¿¡æ¯åŒºæ ‡é¢˜ */
        .info-section h2 { color: #27ae60; margin-bottom: 8px; font-size: 18px; }
        
        /* 16. ä¿¡æ¯ç½‘æ ¼å¸ƒå±€ - æ›´ç´§å‡‘ */
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px; margin-top: 10px; }
        
        /* 17. ä¿¡æ¯é¡¹ - æ›´ç´§å‡‘ */
        .info-item { background: rgba(248, 249, 250, 0.9); padding: 10px; border-radius: 8px; border-left: 3px solid #27ae60; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        
        /* 18. ä¿¡æ¯é¡¹æ‚¬åœæ•ˆæœ */
        .info-item:hover { transform: translateX(5px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        
        /* 19. ä¿¡æ¯æ ‡ç­¾ - æ›´ç´§å‡‘ */
        .info-label { color: #6c757d; font-size: 11px; margin-bottom: 3px; text-transform: uppercase; letter-spacing: 0.5px; }
        
        /* 20. ä¿¡æ¯å†…å®¹ - æ›´ç´§å‡‘ */
        .info-content { color: #2c3e50; font-size: 12px; }
        
        /* 21. Toastæç¤º */
        .toast { position: fixed; bottom: 20px; right: 20px; background: #27ae60; color: white; padding: 12px 20px; border-radius: 6px; font-size: 14px; z-index: 1000; opacity: 0; transform: translateY(10px); transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); }
        
        /* 22. Toastæ˜¾ç¤ºçŠ¶æ€ */
        .toast.show { opacity: 1; transform: translateY(0); }
        
        /* 23. å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) { body { padding: 10px; } pre { padding: 15px; font-size: 12px; } .info-grid { grid-template-columns: 1fr; } }
        
        /* 24. åŠ¨ç”»å®šä¹‰ */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* 25. æ»‘å…¥åŠ¨ç”» */
        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="container">
        <h3>Termux Pythonåº“å®‰è£…è„šæœ¬</h3>
        
        <div class="code-container">
            <div class="code-header">
                <span class="code-title">termux_python_setup.sh</span>
                <button class="copy-btn" id="copyBtn">
                    <span>ğŸ“‹</span>
                    <span id="copyBtnText">å¤åˆ¶</span>
                </button>
            </div>
            <pre><code id="codeContent" class="language-bash">#!/bin/bash
# Termuxç¯å¢ƒä¸‹Pythonåº“æ£€æŸ¥å’Œå®‰è£…è„šæœ¬
# ç”¨äºæ£€æŸ¥å’Œå®‰è£…Wordæ–‡æ¡£å¤„ç†ç›¸å…³çš„Pythonåº“

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# æ—¥å¿—å‡½æ•°
log_info() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

log_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

log_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# æ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨
command_exists() {
    command -v "$1" >/dev/null 2>&1
}

# æ£€æŸ¥PythonåŒ…æ˜¯å¦å®‰è£…
check_python_package() {
    local package=$1
    python -c "import ${package}" 2>/dev/null
    return $?
}

# å®‰è£…TermuxåŒ…
install_termux_package() {
    local package=$1
    log_info "å®‰è£…TermuxåŒ…: $package"
    if pkg install "$package" -y; then
        log_success "TermuxåŒ… $package å®‰è£…æˆåŠŸ"
        return 0
    else
        log_error "TermuxåŒ… $package å®‰è£…å¤±è´¥"
        return 1
    fi
}

# å®‰è£…PythonåŒ…
install_python_package() {
    local package=$1
    local display_name=${2:-$package}
    
    log_info "å®‰è£…PythonåŒ…: $display_name"
    
    # é¦–å…ˆå°è¯•æ™®é€šå®‰è£…
    if pip install "$package" --quiet; then
        log_success "PythonåŒ… $display_name å®‰è£…æˆåŠŸ"
        return 0
    else
        log_warning "æ™®é€šå®‰è£…å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨--userå‚æ•°å®‰è£…"
        # å°è¯•ç”¨æˆ·æ¨¡å¼å®‰è£…
        if pip install --user "$package" --quiet; then
            log_success "PythonåŒ… $display_name ç”¨æˆ·æ¨¡å¼å®‰è£…æˆåŠŸ"
            return 0
        else
            log_error "PythonåŒ… $display_name å®‰è£…å¤±è´¥"
            return 1
        fi
    fi
}

# ä¸»å‡½æ•°
main() {
    echo "========================================"
    echo "  Termux Pythonåº“æ£€æŸ¥å’Œå®‰è£…è„šæœ¬"
    echo "  ç”¨äºWordæ–‡æ¡£å¤„ç†ç›¸å…³åº“"
    echo "========================================"
    echo

    # 1. æ›´æ–°TermuxåŒ…ç®¡ç†å™¨
    log_info "æ›´æ–°TermuxåŒ…ç®¡ç†å™¨..."
    if pkg update -y && pkg upgrade -y; then
        log_success "TermuxåŒ…ç®¡ç†å™¨æ›´æ–°æˆåŠŸ"
    else
        log_error "TermuxåŒ…ç®¡ç†å™¨æ›´æ–°å¤±è´¥"
        exit 1
    fi
    echo

    # 2. æ£€æŸ¥å¹¶å®‰è£…åŸºç¡€ç³»ç»Ÿä¾èµ–
    log_info "æ£€æŸ¥ç³»ç»Ÿä¾èµ–..."
    system_packages=("python" "python-pip" "libxml2" "libxslt" "zlib" "clang")
    
    for pkg in "${system_packages[@]}"; do
        if ! pkg list-installed | grep -q "^$pkg/"; then
            log_warning "$pkg æœªå®‰è£…ï¼Œæ­£åœ¨å®‰è£…..."
            install_termux_package "$pkg" || exit 1
        else
            log_success "$pkg å·²å®‰è£…"
        fi
    done
    echo

    # 3. æ£€æŸ¥Pythonç¯å¢ƒ
    log_info "æ£€æŸ¥Pythonç¯å¢ƒ..."
    if command_exists python; then
        python_version=$(python --version 2>&1)
        log_success "Pythonå·²å®‰è£…: $python_version"
    else
        log_error "Pythonæœªå®‰è£…"
        exit 1
    fi

    if command_exists pip; then
        pip_version=$(pip --version)
        log_success "pipå·²å®‰è£…: $pip_version"
    else
        log_error "pipæœªå®‰è£…"
        exit 1
    fi
    echo

    # 4. æ›´æ–°pip
    log_info "æ›´æ–°pipåˆ°æœ€æ–°ç‰ˆæœ¬..."
    if pip install --upgrade pip --quiet; then
        log_success "pipæ›´æ–°æˆåŠŸ"
    else
        log_warning "pipæ›´æ–°å¤±è´¥ï¼Œç»§ç»­ä½¿ç”¨å½“å‰ç‰ˆæœ¬"
    fi
    echo

    # 5. æ£€æŸ¥å¹¶å®‰è£…Pythonåº“
    log_info "æ£€æŸ¥Pythonåº“..."
    
    # å®šä¹‰éœ€è¦å®‰è£…çš„åº“
    declare -A python_packages=(
        ["lxml"]="lxml"
        ["python-docx"]="python-docx"
        ["docxcompose"]="docxcompose"
    )
    
    for import_name in "${!python_packages[@]}"; do
        package_name="${python_packages[$import_name]}"
        
        if check_python_package "$import_name"; then
            log_success "$package_name å·²å®‰è£…"
        else
            log_warning "$package_name æœªå®‰è£…ï¼Œæ­£åœ¨å®‰è£…..."
            install_python_package "$package_name" "$package_name" || exit 1
        fi
    done
    echo

    # 6. éªŒè¯å®‰è£…
    log_info "éªŒè¯å®‰è£…..."
    python3 -c "
import sys
try:
    import os
    import re
    from docx import Document
    from docxcompose.composer import Composer
    from docx.shared import Pt
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    from docx.oxml.ns import qn
    from docx.oxml import OxmlElement
    print('âœ… æ‰€æœ‰åº“å¯¼å…¥æˆåŠŸï¼')
    print('âœ… Wordæ–‡æ¡£å¤„ç†ç¯å¢ƒé…ç½®å®Œæˆ')
except ImportError as e:
    print(f'âŒ å¯¼å…¥å¤±è´¥: {e}')
    sys.exit(1)
"
    
    if [ $? -eq 0 ]; then
        echo
        log_success "æ‰€æœ‰åº“å®‰è£…éªŒè¯æˆåŠŸï¼"
        echo
        echo "========================================"
        echo "  å®‰è£…å®Œæˆï¼ç°åœ¨å¯ä»¥ä½¿ç”¨Wordå¤„ç†åŠŸèƒ½äº†"
        echo "========================================"
    else
        log_error "éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯"
        exit 1
    fi
}

# è¿è¡Œä¸»å‡½æ•°
main "$@"</code></pre>
        </div>
        
        <div class="info-section">
            <h2>ğŸ“‹ è„šæœ¬åŠŸèƒ½</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">ğŸ¯ åŠŸèƒ½</div>
                    <div class="info-content">è‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…Termuxç¯å¢ƒä¸‹çš„Wordæ–‡æ¡£å¤„ç†Pythonåº“</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ğŸ“ è¾“å‡º</div>
                    <div class="info-content">åœ¨Termuxä¸­é…ç½®å®Œæ•´çš„PythonåŠWordå¤„ç†ç¯å¢ƒ</div>
                </div>
                <div class="info-item">
                    <div class="info-label">âš¡ ç‰¹æ€§</div>
                    <div class="info-content">å½©è‰²æ—¥å¿—è¾“å‡ºã€ä¾èµ–æ£€æŸ¥ã€è‡ªåŠ¨å®‰è£…ã€ç¯å¢ƒéªŒè¯</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ğŸ› ï¸ ä¾èµ–</div>
                    <div class="info-content">éœ€è¦åœ¨Termuxç¯å¢ƒä¸‹è¿è¡Œ</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast æç¤º -->
    <div class="toast" id="toast"></div>

    <script>
        // 1. å¤åˆ¶æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†
        document.getElementById('copyBtn').addEventListener('click', function() {
            const copyBtn = this;
            const copyBtnText = document.getElementById('copyBtnText');
            const toast = document.getElementById('toast');
            
            // è·å–çº¯æ–‡æœ¬å†…å®¹ï¼ˆå»é™¤HTMLæ ‡ç­¾ï¼‰
            const codeElement = document.getElementById('codeContent');
            const textContent = codeElement.textContent || codeElement.innerText;
            
            // ä½¿ç”¨ç°ä»£APIå¤åˆ¶
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textContent).then(function() {
                    // æ˜¾ç¤ºæˆåŠŸæç¤º
                    handleCopySuccess(copyBtn, copyBtnText, toast);
                }).catch(function(err) {
                    showCopyError(copyBtn, copyBtnText, toast);
                });
            } else {
                // å¤‡ç”¨æ–¹æ³•
                fallbackCopy(textContent, copyBtn, copyBtnText, toast);
            }
        });
        
        // 2. å¤„ç†å¤åˆ¶æˆåŠŸ
        function handleCopySuccess(copyBtn, copyBtnText, toast) {
            copyBtn.classList.add('copied');
            copyBtnText.textContent = 'å·²å¤åˆ¶';
            
            // æ˜¾ç¤ºtoast
            toast.textContent = 'âœ… è„šæœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
            toast.classList.add('show');
            
            // 2ç§’åæ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(function() {
                copyBtn.classList.remove('copied');
                copyBtnText.textContent = 'å¤åˆ¶';
            }, 2000);
            
            // 3ç§’åéšè—toast
            setTimeout(function() {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // 3. å¤‡ç”¨å¤åˆ¶æ–¹æ³•
        function fallbackCopy(text, copyBtn, copyBtnText, toast) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.opacity = '0';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    handleCopySuccess(copyBtn, copyBtnText, toast);
                } else {
                    showCopyError(copyBtn, copyBtnText, toast);
                }
            } catch (err) {
                showCopyError(copyBtn, copyBtnText, toast);
            }
            
            document.body.removeChild(textArea);
        }
        
        // 4. æ˜¾ç¤ºå¤åˆ¶é”™è¯¯
        function showCopyError(copyBtn, copyBtnText, toast) {
            // æ˜¾ç¤ºé”™è¯¯æç¤º
            toast.textContent = 'âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶';
            toast.style.background = '#e74c3c';
            toast.classList.add('show');
            
            // 3ç§’åéšè—toast
            setTimeout(function() {
                toast.classList.remove('show');
                toast.style.background = '#27ae60';
            }, 3000);
        }
    </script>
</body>
</html>
