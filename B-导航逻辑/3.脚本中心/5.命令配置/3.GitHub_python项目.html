<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GitHubé¡¹ç›®æŸ¥çœ‹å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255,255,255,0.95);
            --text-primary: #333;
            --text-secondary: #666;
            --border-color: #e0e0e0;
            --accent-color: #667eea;
            --card-shadow: 0 3px 10px rgba(0,0,0,0.1);
            --card-hover-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            padding: 8px;
            font-size: var(--base-font-size, 14px);
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        /* æœç´¢å’Œæ§åˆ¶é¢æ¿ */
        .search-control-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .search-box {
            flex: 1;
            position: relative;
            max-width: 600px;
        }
        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            pointer-events: none;
        }
        .load-time {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            min-width: 80px;
            text-align: right;
        }
        .control-panel-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .control-panel-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        /* é¡¹ç›®å¡ç‰‡ */
        .projects-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        .project-card {
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            height: 140px;
            display: flex;
            flex-direction: column;
        }
        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--card-hover-shadow);
        }
        .project-card:hover::before {
            transform: scaleX(1);
        }
        .project-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            position: relative;
            flex-shrink: 0;
        }
        .project-number {
            position: absolute;
            top: 5px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }
        .project-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 2px;
            word-break: break-all;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .project-index {
            font-size: 10px;
            opacity: 0.9;
        }
        .project-content {
            padding: 8px 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .project-desc {
            color: var(--text-primary);
            font-size: 12px;
            line-height: 1.3;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex: 1;
        }
        .project-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }
        .project-type {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 9px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .view-details {
            color: var(--accent-color);
            font-size: 10px;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        .view-details:hover {
            color: #764ba2;
        }
        /* åˆ†é¡µ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .pagination button {
            padding: 8px 12px;
            border: none;
            background: var(--card-bg);
            color: var(--accent-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 32px;
            font-size: 13px;
        }
        .pagination button:hover:not(:disabled) {
            background: white;
            transform: translateY(-1px);
            box-shadow: var(--card-shadow);
        }
        .pagination button.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .page-info {
            color: white;
            font-weight: 600;
            padding: 0 12px;
            font-size: 13px;
        }
        /* æ§åˆ¶é¢æ¿å¼¹çª— */
        .control-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        .control-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        .control-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--text-primary);
        }
        .control-close {
            background: #f44336;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        .control-close:hover {
            background: #d32f2f;
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }
        .control-input {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        .control-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        .control-btn {
            width: 100%;
            padding: 12px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .control-btn:hover {
            background: #5a67d8;
        }
        .font-size-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .font-btn {
            flex: 1;
            padding: 8px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        .font-btn:hover {
            background: #e0e0e0;
        }
        .font-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        /* é¡¹ç›®è¯¦æƒ…å¼¹çª— */
        .project-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        .project-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            max-width: 90%;
            max-height: 80%;
            width: 800px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .project-header-modal {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        .project-title {
            font-size: 16px;
            color: var(--text-primary);
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .project-index-modal {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        .project-close {
            background: #f44336;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        .project-close:hover {
            background: #d32f2f;
        }
        .project-body {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            overflow: auto;
            white-space: pre-wrap;
            flex: 1;
        }
        .project-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .project-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .copy-btn {
            background: #2196F3;
            color: white;
        }
        .github-btn {
            background: #24292e;
            color: white;
        }
        .project-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            text-align: center;
            color: white;
            padding: 40px;
            font-size: 16px;
        }
        .loading::after {
            content: '';
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .projects-container {
                grid-template-columns: 1fr;
            }
            .search-control-container {
                flex-direction: row;
                align-items: stretch;
            }
            .search-box {
                max-width: none;
            }
            .load-time {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æœç´¢å’Œæ§åˆ¶é¢æ¿ -->
        <div class="search-control-container">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢GitHubé¡¹ç›®åç§°æˆ–æè¿°...">
                <span class="search-icon">ğŸ”</span>
            </div>
            <div class="load-time" id="loadTime">åŠ è½½ä¸­...</div>
            <button class="control-panel-btn" onclick="openControlPanel()">âš™ï¸ æ§åˆ¶é¢æ¿</button>
        </div>

        <!-- é¡¹ç›®å®¹å™¨ -->
        <div class="projects-container" id="projectsContainer">
            <div class="loading">æ­£åœ¨åˆå§‹åŒ–...</div>
        </div>

        <!-- åˆ†é¡µ -->
        <div class="pagination" id="pagination"></div>
    </div>

    <!-- æ§åˆ¶é¢æ¿å¼¹çª— -->
    <div class="control-modal" id="controlModal">
        <div class="control-content">
            <div class="control-header">
                <div class="control-title">æ§åˆ¶é¢æ¿</div>
                <button class="control-close" onclick="closeControlPanel()">âœ•</button>
            </div>
            
            <div class="control-group">
                <label class="control-label">è·³è½¬åˆ°é¡µé¢:</label>
                <input type="number" class="control-input" id="gotoPageInput" placeholder="è¾“å…¥é¡µç " min="1">
                <button class="control-btn" onclick="gotoPage()" style="margin-top: 10px;">è·³è½¬</button>
            </div>

            <div class="control-group">
                <label class="control-label">å­—ä½“å¤§å°:</label>
                <div class="font-size-controls">
                    <button class="font-btn" onclick="setFontSize(12)">å°</button>
                    <button class="font-btn active" onclick="setFontSize(14)">ä¸­</button>
                    <button class="font-btn" onclick="setFontSize(16)">å¤§</button>
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">èƒŒæ™¯é¢œè‰²:</label>
                <input type="color" class="control-input" id="bgColorInput" value="#667eea">
                <button class="control-btn" onclick="changeBgColor()" style="margin-top: 10px;">åº”ç”¨èƒŒæ™¯</button>
            </div>

            <div class="control-group">
                <label class="control-label">ç¼“å­˜ä¿¡æ¯:</label>
                <div style="font-size: 13px; color: #666;">
                    <div>å½“å‰é¡µé¢: <span id="currentPageInfo">1</span></div>
                    <div>ç¼“å­˜çŠ¶æ€: <span id="cacheStatusInfo">æœªç¼“å­˜</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡¹ç›®è¯¦æƒ…å¼¹çª— -->
    <div class="project-modal" id="projectModal">
        <div class="project-content">
            <div class="project-header-modal">
                <div class="project-title">
                    <span class="project-index-modal" id="projectIndex">1</span>
                    <span id="projectName">é¡¹ç›®åç§°</span>
                </div>
                <button class="project-close" onclick="closeProjectModal()">âœ• å…³é—­</button>
            </div>
            <div class="project-body" id="projectBody">é¡¹ç›®å†…å®¹</div>
            <div class="project-actions">
                <button class="project-btn copy-btn" onclick="copyProjectContent()">ğŸ“‹ å¤åˆ¶å†…å®¹</button>
                <button class="project-btn github-btn" onclick="openGitHubRepo()">ğŸ”— æ‰“å¼€GitHub</button>
            </div>
        </div>
    </div>

    <script>
        // ===== é…ç½®å˜é‡ï¼ˆæ˜“äºç»´æŠ¤ï¼‰ =====
        const CONFIG = {
            // é…ç½®æ–‡ä»¶å - ä¿®æ”¹è¿™é‡Œå³å¯æ›´æ¢é…ç½®æ–‡ä»¶
            CONFIG_FILE_NAME: '3.2025_GITHUBé¡¹ç›®_å»é‡å.js',
            
            // ç¼“å­˜é”®å
            CACHE_KEY: 'github-config',
            PAGE_CACHE_KEY: 'github-page-cache',
            
            // åˆ†é¡µè®¾ç½®
            PROJECTS_PER_PAGE: 24,
            
            // å…¶ä»–è®¾ç½®
            DEBUG_MODE: true
        };

        // ===== å…¨å±€å˜é‡ =====
        let allProjects = [];
        let filteredProjects = [];
        let currentPage = 1;
        let totalPages = 1;
        let configLoaded = false;
        let currentProject = null;
        let loadStartTime = 0;

        // ===== ç¼“å­˜ç®¡ç† =====
        window.GitHubCache = window.GitHubCache || {
            has: function(key) {
                return this.cache && this.cache[key];
            },
            get: function(key) {
                if (this.has(key)) {
                    if (CONFIG.DEBUG_MODE) console.log(`ğŸ“¦ ä»ç¼“å­˜åŠ è½½: ${key}`);
                    return this.cache[key];
                }
                return null;
            },
            set: function(key, data) {
                if (!this.cache) {
                    this.cache = {};
                }
                this.cache[key] = data;
                if (CONFIG.DEBUG_MODE) console.log(`ğŸ’¾ ç¼“å­˜å·²ä¿å­˜: ${key}`);
            },
            remove: function(key) {
                if (this.has(key)) {
                    delete this.cache[key];
                    if (CONFIG.DEBUG_MODE) console.log(`ğŸ—‘ï¸ ç¼“å­˜å·²æ¸…é™¤: ${key}`);
                }
            },
            clear: function() {
                this.cache = {};
                if (CONFIG.DEBUG_MODE) console.log('ğŸ§¹ æ‰€æœ‰ç¼“å­˜å·²æ¸…é™¤');
            },
            stats: function() {
                const count = this.cache ? Object.keys(this.cache).length : 0;
                if (CONFIG.DEBUG_MODE) console.log(`ğŸ“Š ç¼“å­˜ç»Ÿè®¡: ${count} ä¸ªé…ç½®å·²ç¼“å­˜`);
                return count;
            }
        };

        // ===== é¡µé¢ç¼“å­˜ç®¡ç† =====
        function savePageToCache() {
            const pageData = {
                page: currentPage,
                timestamp: Date.now()
            };
            localStorage.setItem(CONFIG.PAGE_CACHE_KEY, JSON.stringify(pageData));
            if (CONFIG.DEBUG_MODE) console.log(`ğŸ’¾ é¡µé¢ç¼“å­˜å·²ä¿å­˜: ç¬¬${currentPage}é¡µ`);
        }

        function loadPageFromCache() {
            try {
                const cached = localStorage.getItem(CONFIG.PAGE_CACHE_KEY);
                if (cached) {
                    const pageData = JSON.parse(cached);
                    // æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼ˆ24å°æ—¶ï¼‰
                    if (Date.now() - pageData.timestamp < 24 * 60 * 60 * 1000) {
                        return pageData.page;
                    }
                }
            } catch (e) {
                console.error('é¡µé¢ç¼“å­˜è¯»å–å¤±è´¥:', e);
            }
            return 1;
        }

        // ===== åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶ =====
        function loadConfigWithCache() {
            return new Promise((resolve, reject) => {
                if (configLoaded) {
                    if (CONFIG.DEBUG_MODE) console.log('âœ… é…ç½®å·²åŠ è½½ï¼Œç›´æ¥ä½¿ç”¨');
                    resolve();
                    return;
                }

                // æ£€æŸ¥ç¼“å­˜
                const cachedData = window.GitHubCache.get(CONFIG.CACHE_KEY);
                if (cachedData) {
                    if (CONFIG.DEBUG_MODE) console.log('ğŸš€ ä½¿ç”¨ç¼“å­˜æ•°æ®ï¼Œæ— éœ€é‡æ–°ä¸‹è½½');
                    // å°†ç¼“å­˜æ•°æ®åº”ç”¨åˆ°windowå¯¹è±¡
                    Object.assign(window, cachedData);
                    configLoaded = true;
                    updateCacheStatus('å·²ç¼“å­˜');
                    resolve();
                    return;
                }

                if (CONFIG.DEBUG_MODE) console.log(`â¬‡ï¸ å¼€å§‹ä¸‹è½½é…ç½®æ–‡ä»¶: ${CONFIG.CONFIG_FILE_NAME}`);
                loadStartTime = Date.now();
                
                // åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾
                const script = document.createElement('script');
                script.src = CONFIG.CONFIG_FILE_NAME;
                script.onload = () => {
                    const loadTime = Date.now() - loadStartTime;
                    if (CONFIG.DEBUG_MODE) console.log(`âœ… é…ç½®æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œè€—æ—¶: ${loadTime}ms`);
                    
                    // å°†é…ç½®æ•°æ®ç¼“å­˜åˆ°window.GitHubCache
                    const configData = {};
                    // æ”¶é›†æ‰€æœ‰é¡¹ç›®å˜é‡ï¼ˆgh001åˆ°gh300ï¼‰
                    for (let i = 1; i <= 300; i++) {
                        const varName = 'gh' + String(i).padStart(3, '0');
                        if (window[varName]) {
                            configData[varName] = window[varName];
                        }
                    }
                    // ç¼“å­˜gh_list
                    if (window.gh_list) {
                        configData.gh_list = window.gh_list;
                    }
                    
                    // ä¿å­˜åˆ°ç¼“å­˜
                    window.GitHubCache.set(CONFIG.CACHE_KEY, configData);
                    
                    configLoaded = true;
                    updateCacheStatus('å·²åŠ è½½');
                    updateLoadTime(loadTime);
                    resolve();
                };
                script.onerror = () => {
                    console.error(`âŒ é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: ${CONFIG.CONFIG_FILE_NAME}`);
                    updateLoadTime('åŠ è½½å¤±è´¥');
                    reject(new Error(`é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: ${CONFIG.CONFIG_FILE_NAME}`));
                };
                document.head.appendChild(script);
            });
        }

        // ===== æ›´æ–°çŠ¶æ€æ˜¾ç¤º =====
        function updateCacheStatus(status) {
            const cacheStatusEl = document.getElementById('cacheStatusInfo');
            if (cacheStatusEl) {
                cacheStatusEl.textContent = status;
            }
        }

        function updateLoadTime(time) {
            const loadTimeEl = document.getElementById('loadTime');
            if (loadTimeEl) {
                if (typeof time === 'number') {
                    loadTimeEl.textContent = `${time}ms`;
                } else {
                    loadTimeEl.textContent = time;
                }
            }
        }

        function updateCurrentPageInfo() {
            const currentPageEl = document.getElementById('currentPageInfo');
            if (currentPageEl) {
                currentPageEl.textContent = currentPage;
            }
        }

        // ===== æ§åˆ¶é¢æ¿åŠŸèƒ½ =====
        function openControlPanel() {
            document.getElementById('controlModal').style.display = 'flex';
            document.getElementById('gotoPageInput').value = currentPage;
            updateCurrentPageInfo();
            updateCacheStatus(window.GitHubCache.has(CONFIG.CACHE_KEY) ? 'å·²ç¼“å­˜' : 'æœªç¼“å­˜');
        }

        function closeControlPanel() {
            document.getElementById('controlModal').style.display = 'none';
        }

        function gotoPage() {
            const input = document.getElementById('gotoPageInput');
            const page = parseInt(input.value);
            
            if (page && page >= 1 && page <= totalPages) {
                currentPage = page;
                renderProjects();
                renderPagination();
                savePageToCache();
                closeControlPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                alert(`è¯·è¾“å…¥æœ‰æ•ˆçš„é¡µç  (1-${totalPages})`);
            }
        }

        function setFontSize(size) {
            document.documentElement.style.setProperty('--base-font-size', `${size}px`);
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.font-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('preferred-font-size', size);
        }

        function changeBgColor() {
            const color = document.getElementById('bgColorInput').value;
            const color2 = adjustColor(color, -20);
            document.documentElement.style.setProperty('--bg-primary', `linear-gradient(135deg, ${color} 0%, ${color2} 100%)`);
            
            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('preferred-bg-color', color);
        }

        function adjustColor(color, amount) {
            const num = parseInt(color.replace('#', ''), 16);
            const r = Math.max(0, Math.min(255, (num >> 16) + amount));
            const g = Math.max(0, Math.min(255, ((num >> 8) & 0x00FF) + amount));
            const b = Math.max(0, Math.min(255, (num & 0x0000FF) + amount));
            return `#${((r << 16) | (g << 8) | b).toString(16).padStart(6, '0')}`;
        }

        // ===== åˆå§‹åŒ– =====
        document.addEventListener('DOMContentLoaded', function() {
            if (CONFIG.DEBUG_MODE) console.log('ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–');
            
            // æ¢å¤ç”¨æˆ·åå¥½è®¾ç½®
            const savedFontSize = localStorage.getItem('preferred-font-size');
            if (savedFontSize) {
                document.documentElement.style.setProperty('--base-font-size', `${savedFontSize}px`);
            }
            
            const savedBgColor = localStorage.getItem('preferred-bg-color');
            if (savedBgColor) {
                document.getElementById('bgColorInput').value = savedBgColor;
                const color2 = adjustColor(savedBgColor, -20);
                document.documentElement.style.setProperty('--bg-primary', `linear-gradient(135deg, ${savedBgColor} 0%, ${color2} 100%)`);
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('projectsContainer').innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½é…ç½®æ–‡ä»¶...</div>';
            
            // æ˜¾ç¤ºç¼“å­˜ç»Ÿè®¡
            window.GitHubCache.stats();
            
            // ä»ç¼“å­˜æ¢å¤é¡µé¢
            currentPage = loadPageFromCache();
            
            // åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶ï¼ˆå¸¦ç¼“å­˜ï¼‰
            loadConfigWithCache()
                .then(() => {
                    if (CONFIG.DEBUG_MODE) console.log('ğŸ“š é…ç½®åŠ è½½æˆåŠŸï¼Œå¼€å§‹åˆå§‹åŒ–æ•°æ®');
                    initializeData();
                })
                .catch(error => {
                    console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                    document.getElementById('projectsContainer').innerHTML = 
                        `<div class="loading">é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: ${error.message}</div>`;
                    updateLoadTime('åŠ è½½å¤±è´¥');
                });
        });

        // ===== åˆå§‹åŒ–æ•°æ® =====
        function initializeData() {
            if (typeof gh_list === 'undefined') {
                document.getElementById('projectsContainer').innerHTML = '<div class="loading">é…ç½®æ–‡ä»¶æœªæ­£ç¡®åŠ è½½</div>';
                return;
            }

            allProjects = [...gh_list];
            filteredProjects = [...allProjects];
            
            if (CONFIG.DEBUG_MODE) console.log(`ğŸ“Š æˆåŠŸåŠ è½½ ${allProjects.length} ä¸ªGitHubé¡¹ç›®`);
            
            // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
            renderProjects();
            renderPagination();
            
            // ç»‘å®šæœç´¢äº‹ä»¶
            document.getElementById('searchInput').addEventListener('input', handleSearch);
        }

        // ===== æœç´¢å¤„ç† =====
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            if (searchTerm === '') {
                filteredProjects = [...allProjects];
            } else {
                filteredProjects = allProjects.filter(project =>
                    project.repo.toLowerCase().includes(searchTerm) ||
                    project.desc.toLowerCase().includes(searchTerm) ||
                    project.raw.toLowerCase().includes(searchTerm)
                );
            }
            currentPage = 1;
            renderProjects();
            renderPagination();
        }

        // ===== æ¸²æŸ“é¡¹ç›®åˆ—è¡¨ =====
        function renderProjects() {
            const startIndex = (currentPage - 1) * CONFIG.PROJECTS_PER_PAGE;
            const endIndex = startIndex + CONFIG.PROJECTS_PER_PAGE;
            const pageProjects = filteredProjects.slice(startIndex, endIndex);

            if (pageProjects.length === 0) {
                document.getElementById('projectsContainer').innerHTML = '<div class="loading">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®</div>';
                return;
            }

            let html = '';
            pageProjects.forEach((project, index) => {
                const globalIndex = startIndex + index + 1;
                html += `
                    <div class="project-card" onclick="showProjectDetails(${project.index})">
                        <div class="project-header">
                            <div class="project-number">#${globalIndex}</div>
                            <div class="project-name">${project.repo}</div>
                            <div class="project-index">Index: ${project.index}</div>
                        </div>
                        <div class="project-content">
                            <div class="project-desc">${project.desc}</div>
                            <div class="project-meta">
                                <span class="project-type">${project.type}</span>
                                <a href="#" class="view-details" onclick="event.stopPropagation(); showProjectDetails(${project.index})">æŸ¥çœ‹è¯¦æƒ… â†’</a>
                            </div>
                        </div>
                    </div>
                `;
            });
            document.getElementById('projectsContainer').innerHTML = html;
            
            // ä¿å­˜å½“å‰é¡µé¢åˆ°ç¼“å­˜
            savePageToCache();
            updateCurrentPageInfo();
        }

        // ===== æ¸²æŸ“åˆ†é¡µ =====
        function renderPagination() {
            const pagination = document.getElementById('pagination');
            totalPages = Math.ceil(filteredProjects.length / CONFIG.PROJECTS_PER_PAGE);

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let paginationHTML = '';
            paginationHTML += `<button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>ä¸Šä¸€é¡µ</button>`;
            
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    paginationHTML += `<button onclick="changePage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    paginationHTML += `<span style="color:white;">...</span>`;
                }
            }
            
            paginationHTML += `<button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>ä¸‹ä¸€é¡µ</button>`;
            paginationHTML += `<span class="page-info">ç¬¬ ${currentPage} / ${totalPages} é¡µ</span>`;
            
            pagination.innerHTML = paginationHTML;
        }

        // ===== åˆ‡æ¢é¡µé¢ =====
        function changePage(page) {
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderProjects();
                renderPagination();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // ===== æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ… =====
        function showProjectDetails(index) {
            const project = allProjects.find(p => p.index === index);
            if (!project) return;
            
            currentProject = project;
            document.getElementById('projectIndex').textContent = `#${project.index}`;
            document.getElementById('projectName').textContent = project.repo;
            document.getElementById('projectBody').textContent = `é¡¹ç›®æè¿°:\n${project.desc}\n\nè¯¦ç»†ä¿¡æ¯:\n${project.raw}`;
            document.getElementById('projectModal').style.display = 'flex';
        }

        // ===== å…³é—­é¡¹ç›®å¼¹çª— =====
        function closeProjectModal() {
            document.getElementById('projectModal').style.display = 'none';
            currentProject = null;
        }

        // ===== å¤åˆ¶é¡¹ç›®å†…å®¹ =====
        function copyProjectContent() {
            if (!currentProject) return;
            
            const content = `é¡¹ç›®: ${currentProject.repo}\næè¿°: ${currentProject.desc}\nè¯¦ç»†ä¿¡æ¯: ${currentProject.raw}`;
            navigator.clipboard.writeText(content).then(() => {
                showToast('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = content;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }

        // ===== æ‰“å¼€GitHubä»“åº“ =====
        function openGitHubRepo() {
            if (!currentProject) return;
            window.open(`https://github.com/${currentProject.repo}`, '_blank');
        }

        // ===== æ˜¾ç¤ºæç¤ºæ¶ˆæ¯ =====
        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                right: 30px;
                background: #4CAF50;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                font-size: 14px;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        // ===== æ·»åŠ åŠ¨ç”»æ ·å¼ =====
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ===== ESCé”®å…³é—­å¼¹çª— =====
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeProjectModal();
                closeControlPanel();
            }
        });
        document.getElementById('projectModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeProjectModal();
            }
        });
        document.getElementById('controlModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeControlPanel();
            }
        });

        // ===== è°ƒè¯•å·¥å…· =====
        if (CONFIG.DEBUG_MODE) {
            console.log('ğŸ”§ ç¼“å­˜ç®¡ç†å·¥å…·å·²åŠ è½½ï¼Œä½¿ç”¨ GitHubCache å¯¹è±¡ç®¡ç†ç¼“å­˜');
            console.log('ğŸ”§ é…ç½®ä¿¡æ¯:', CONFIG);
            console.log('ğŸ’¡ ä½¿ç”¨æ–¹æ³•:');
            console.log('  GitHubCache.stats() - æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡');
            console.log('  GitHubCache.clear() - æ¸…é™¤æ‰€æœ‰ç¼“å­˜');
            console.log(`  GitHubCache.remove("${CONFIG.CACHE_KEY}") - æ¸…é™¤æŒ‡å®šç¼“å­˜`);
        }
    </script>
</body>
</html>
