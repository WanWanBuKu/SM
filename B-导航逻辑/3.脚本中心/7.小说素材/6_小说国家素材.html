<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒå‰10å›½å®¶ç»¼åˆå®åŠ›é€ŸæŸ¥è¡¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 8px;
            line-height: 1.3;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 12px;
            padding: 8px;
        }
        
        .header h1 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 4px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 0.7rem;
            opacity: 0.9;
        }
        
        .selector {
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .selector select {
            width: 100%;
            padding: 8px;
            font-size: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }
        
        .category-card {
            background: white;
            border-radius: 12px;
            margin-bottom: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .category-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .category-header {
            padding: 8px 10px;
            font-weight: 600;
            font-size: 0.8rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .category-icon {
            width: 18px;
            height: 18px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
        }
        
        .category-content {
            padding: 6px 10px;
        }
        
        .indicator-table {
            width: 100%;
            font-size: 0.65rem;
            border-collapse: collapse;
        }
        
        .indicator-table tr {
            border-bottom: 1px solid #f0f0f0;
        }
        
        .indicator-table tr:last-child {
            border-bottom: none;
        }
        
        .indicator-table td {
            padding: 3px 2px;
            vertical-align: top;
        }
        
        .indicator-name {
            font-weight: 500;
            color: #333;
            width: 18%;
        }
        
        .indicator-metrics {
            color: #666;
            width: 42%;
            font-size: 0.6rem;
        }
        
        .indicator-desc {
            color: #999;
            width: 40%;
            font-size: 0.55rem;
        }
        
        .framework-section {
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 8px;
        }
        
        .framework-title {
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 6px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .quick-check {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-bottom: 6px;
        }
        
        .check-item {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 5px;
            border-radius: 6px;
            font-size: 0.6rem;
        }
        
        .check-item strong {
            display: block;
            color: #333;
            margin-bottom: 2px;
        }
        
        .scoring-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 4px;
            margin-bottom: 6px;
        }
        
        .score-item {
            background: #f8f9fa;
            padding: 3px 5px;
            border-radius: 4px;
            font-size: 0.55rem;
            display: flex;
            justify-content: space-between;
        }
        
        .risk-list {
            list-style: none;
            padding: 0;
        }
        
        .risk-item {
            background: #fff3cd;
            padding: 3px 5px;
            margin-bottom: 2px;
            border-radius: 4px;
            font-size: 0.6rem;
            border-left: 3px solid #ffc107;
        }
        
        .tips-section {
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            padding: 10px;
        }
        
        .data-sources {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 3px;
            margin-bottom: 6px;
        }
        
        .source-item {
            font-size: 0.55rem;
            color: #666;
        }
        
        .source-item strong {
            color: #333;
        }
        
        .motto {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.65rem;
            font-weight: 500;
            margin-top: 6px;
        }
        
        /* æ¸å˜è‰²å®šä¹‰ */
        .gradient-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .gradient-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .gradient-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .gradient-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .gradient-6 { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); }
        .gradient-7 { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .loading-spinner {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 380px) {
            .indicator-table {
                font-size: 0.6rem;
            }
            .indicator-metrics, .indicator-desc {
                font-size: 0.55rem;
            }
            .check-item {
                font-size: 0.55rem;
            }
            .score-item {
                font-size: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ å…¨çƒå‰10å›½å®¶ç»¼åˆå®åŠ›é€ŸæŸ¥è¡¨</h1>
            <p>å¿«é€ŸæŒæ¡å›½å®¶æ ¸å¿ƒå®åŠ›ä¸æ½œåœ¨é£é™©</p>
        </div>
        
        <div class="selector">
            <select id="countrySelect" onchange="changeCountry()">
                <option value="usa">ç¾å›½</option>
                <option value="russia">ä¿„ç½—æ–¯</option>
                <option value="india">å°åº¦</option>
                <option value="uk">è‹±å›½</option>
                <option value="skorea">éŸ©å›½</option>
                <option value="pakistan">å·´åŸºæ–¯å¦</option>
                <option value="france">æ³•å›½</option>
                <option value="turkey">åœŸè€³å…¶</option>
                <option value="italy">æ„å¤§åˆ©</option>
                <option value="japan">æ—¥æœ¬</option>
            </select>
        </div>

        <div id="contentContainer">
            <div class="loading">
                <div class="loading-spinner"></div>
                æ­£åœ¨åŠ è½½æ•°æ®...
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ•°æ®åº“ç®¡ç†å™¨ -->
    <script src="/db.js"></script>
    <script src="6_å°è¯´å›½å®¶ç´ æé…ç½®.js"></script>
    
    <script>
        // åŠ è½½é…ç½®æ–‡ä»¶å¹¶ç¼“å­˜
        async function loadCountryData() {
            try {
                // ä½¿ç”¨IDB.CacheMgrè·å–é…ç½®æ–‡ä»¶ï¼ˆä¼˜å…ˆä»ç¼“å­˜ï¼‰
                const configText = await IDB.CacheMgr.get('6_å°è¯´å›½å®¶ç´ æé…ç½®.js');
                
                // æ‰§è¡Œé…ç½®æ–‡ä»¶å†…å®¹
                eval(configText);
                
                // åˆå§‹åŒ–é¡µé¢
                changeCountry();
                
                // ç¼“å­˜å½“å‰é€‰æ‹©çš„å›½å®¶
                const savedCountry = await IDB.get('E_currentCountry', 'userdata');
                if (savedCountry) {
                    document.getElementById('countrySelect').value = savedCountry;
                    changeCountry();
                }
            } catch (error) {
                console.error('åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥:', error);
                document.getElementById('contentContainer').innerHTML = 
                    `<div class="loading" style="flex-direction: column; gap: 15px;">
                        <div style="color: #ff6b6b; font-size: 1.1rem;">âš ï¸ æ•°æ®åŠ è½½å¤±è´¥</div>
                        <div style="font-size: 0.9rem;">è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•</div>
                        <button onclick="location.reload()" style="
                            padding: 8px 16px;
                            background: rgba(255,255,255,0.2);
                            border: 1px solid white;
                            color: white;
                            border-radius: 20px;
                            cursor: pointer;
                            margin-top: 10px;
                            font-size: 0.8rem;
                        ">é‡æ–°åŠ è½½</button>
                    </div>`;
            }
        }

        function changeCountry() {
            const select = document.getElementById('countrySelect');
            const countryKey = select.value;
            const data = countryData[countryKey];
            const container = document.getElementById('contentContainer');
            container.innerHTML = '';

            // ä¿å­˜å½“å‰é€‰æ‹©çš„å›½å®¶åˆ°æ•°æ®åº“
            IDB.put('E_currentCountry', countryKey, 'userdata');

            // æ¸²æŸ“æ‰€æœ‰åˆ†ç±»å¡ç‰‡
            data.categories.forEach((cat, index) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-card';

                const header = document.createElement('div');
                header.className = `category-header gradient-${(index % 7) + 1}`;
                header.innerHTML = `
                    <div class="category-icon">${cat.icon}</div>
                    <span>${index + 1}. ${cat.title}</span>
                `;

                const contentDiv = document.createElement('div');
                contentDiv.className = 'category-content';

                const table = document.createElement('table');
                table.className = 'indicator-table';
                
                cat.items.forEach(item => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="indicator-name">${item.name}</td>
                        <td class="indicator-metrics">${item.metrics}</td>
                        <td class="indicator-desc">${item.desc}</td>
                    `;
                    table.appendChild(tr);
                });

                contentDiv.appendChild(table);
                categoryDiv.appendChild(header);
                categoryDiv.appendChild(contentDiv);
                container.appendChild(categoryDiv);
            });

            // æ·»åŠ è¯„ä¼°æ¡†æ¶
            const frameworkDiv = document.createElement('div');
            frameworkDiv.className = 'framework-section';
            frameworkDiv.innerHTML = `
                <div class="framework-title">
                    <span>ğŸ”</span>
                    <span>å¿«é€Ÿè¯„ä¼°æ¡†æ¶</span>
                </div>
                <div class="quick-check">
                    <div class="check-item">
                        <strong>ä¸‰åˆ†é’Ÿé€ŸæŸ¥æ³•</strong>
                        1.çœ‹è§„æ¨¡ï¼šGDPã€äººå£ã€å›½åœŸ<br>
                        2.çœ‹ç¡¬å®åŠ›ï¼šå†›è´¹ã€åˆ¶é€ ã€èƒ½æº<br>
                        3.çœ‹è½¯å®åŠ›ï¼šæ•™è‚²ã€ç§‘æŠ€ã€å½±å“<br>
                        4.çœ‹æ½œåŠ›ï¼šäººå£ã€èµ„æºã€åˆ›æ–°
                    </div>
                    <div class="check-item">
                        <strong>ç»¼åˆè¯„åˆ†æ³•</strong>
                        ç»æµ40%ï¼šGDP15%+åˆ¶é€ 15%+è´¸æ˜“10%<br>
                        å†›äº‹30%ï¼šå†›è´¹15%+è£…å¤‡10%+æ ¸5%<br>
                        ç§‘æŠ€20%ï¼šç ”å‘10%+æ•™è‚²10%<br>
                        èµ„æº10%ï¼šèƒ½æº5%+äººå£5%
                    </div>
                </div>
                <div class="framework-title">
                    <span>ğŸš¨</span>
                    <span>é£é™©é¢„è­¦æŒ‡æ ‡</span>
                </div>
                <ul class="risk-list">
                    <li class="risk-item">èƒ½æºè¿›å£ä¾èµ–åº¦>70%</li>
                    <li class="risk-item">å¤–æ±‡å‚¨å¤‡<3ä¸ªæœˆè¿›å£é¢</li>
                    <li class="risk-item">æ”¿åºœå€ºåŠ¡å GDP>100%</li>
                    <li class="risk-item">äººå£è€é¾„åŒ–ç‡>20%</li>
                    <li class="risk-item">åŸºå°¼ç³»æ•°>0.4</li>
                </ul>
            `;
            container.appendChild(frameworkDiv);

            // æ·»åŠ å®ç”¨æŠ€å·§
            const tipsDiv = document.createElement('div');
            tipsDiv.className = 'tips-section';
            tipsDiv.innerHTML = `
                <div class="framework-title">
                    <span>ğŸ“‹</span>
                    <span>æ•°æ®æ¥æºé€ŸæŸ¥</span>
                </div>
                <div class="data-sources">
                    <div class="source-item"><strong>ç»æµï¼š</strong>ä¸–ç•Œé“¶è¡Œã€IMFã€ç»Ÿè®¡å±€</div>
                    <div class="source-item"><strong>å†›äº‹ï¼š</strong>SIPRIã€IISSã€å›½é˜²éƒ¨</div>
                    <div class="source-item"><strong>ç§‘æŠ€ï¼š</strong>WIPOä¸“åˆ©ã€QSæ’å</div>
                    <div class="source-item"><strong>èƒ½æºï¼š</strong>IEAã€OPECã€BPç»Ÿè®¡</div>
                </div>
                <div class="motto">
                    ğŸ’¡ å¿«é€Ÿåˆ¤æ–­å£è¯€ï¼š<br>
                    ç»æµçœ‹åˆ¶é€ ï¼Œå†›äº‹çœ‹æµ·å†›ï¼Œç§‘æŠ€çœ‹ä¸“åˆ©ï¼Œèƒ½æºçœ‹å‚¨å¤‡ï¼Œæœªæ¥çœ‹æ•™è‚²
                </div>
            `;
            container.appendChild(tipsDiv);

            // ä¿å­˜æµè§ˆå†å²
            saveViewHistory(countryKey);
        }

        // ä¿å­˜æµè§ˆå†å²
        async function saveViewHistory(countryKey) {
            try {
                const history = await IDB.get('E_viewHistory', 'userdata') || [];
                const now = new Date().toISOString();
                
                // æ·»åŠ æ–°çš„æµè§ˆè®°å½•
                history.unshift({
                    country: countryKey,
                    timestamp: now
                });
                
                // åªä¿ç•™æœ€è¿‘20æ¡è®°å½•
                if (history.length > 20) {
                    history.splice(20);
                }
                
                await IDB.put('E_viewHistory', history, 'userdata');
            } catch (error) {
                console.error('ä¿å­˜æµè§ˆå†å²å¤±è´¥:', error);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–æ•°æ®åº“
            IDB.init().then(() => {
                console.log('æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ');
                // åŠ è½½é…ç½®æ–‡ä»¶
                loadCountryData();
            }).catch(error => {
                console.error('æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥:', error);
                document.getElementById('contentContainer').innerHTML = 
                    `<div class="loading" style="flex-direction: column; gap: 15px;">
                        <div style="color: #ff6b6b; font-size: 1.1rem;">âš ï¸ æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥</div>
                        <div style="font-size: 0.9rem;">è¯·æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒIndexedDB</div>
                    </div>`;
            });
        });
    </script>
</body>
</html>
