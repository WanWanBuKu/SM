<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£ç æ–‡ä»¶åˆå¹¶å·¥å…· - Pythonè„šæœ¬</title>
    
    <!-- prism.js è¯­æ³•é«˜äº® -->
    <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/1.prism-css-ç™½è‰²ä¸»é¢˜.js"></script>   
    <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-core.min.js"></script>
    <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-python.min.js"></script>
    
    <!-- å¼•å…¥ç¼©æ”¾æ’ä»¶ -->
    <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶å·¥å…·/3.æ’ä»¶_å­—ä½“ç¼©æ”¾.js"></script>
    
    
    <style>
        /* å…¨å±€é‡ç½®å’ŒåŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 0.9rem; /* è°ƒæ•´å­—ä½“å¤§å°ä¸º0.9rem */
            background: linear-gradient(135deg, #1a2942 0%, #2d4262 100%);
            min-height: 100vh;
            padding: 10px;
            position: relative;
            overflow-x: hidden;
            color: #333;
        }
        
        /* å¾®å¦™çš„èƒŒæ™¯çº¹ç† */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255,255,255,0.04) 0%, transparent 50%),
                radial-gradient(circle at 90% 90%, rgba(255,255,255,0.02) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: calc(150vh); /* å‡å»padding */
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 20px;
            border-radius: 10px;
            margin: 0 10px 15px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            flex-shrink: 0; /* é˜²æ­¢å¤´éƒ¨è¢«å‹ç¼© */
        }
        
        h1 {
            font-size: 1.2rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* å¤åˆ¶æŒ‰é’® */
        .copy-all-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .copy-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }
        
        /* ä»£ç å—å®¹å™¨ - æ‰©å¤§æ˜¾ç¤ºåŒºåŸŸ */
        .code-block {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            margin: 0 10px 15px 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            transition: all 0.3s ease;
            flex: 1; /* è®©ä»£ç å—å æ®å‰©ä½™ç©ºé—´ */
            display: flex;
            flex-direction: column;
        }
        
        .code-block:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* æ¨¡å—æ ‡é¢˜æ  */
        .module-title {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* é˜²æ­¢æ ‡é¢˜æ è¢«å‹ç¼© */
        }
        
        /* ä»£ç åŒºåŸŸ - æ‰©å¤§æ˜¾ç¤ºåŒºåŸŸ */
        .module-code {
            padding: 0;
            flex: 1; /* è®©ä»£ç åŒºåŸŸå æ®å‰©ä½™ç©ºé—´ */
            overflow: auto; /* ç¡®ä¿å†…å®¹å¯æ»šåŠ¨ */
        }
        
        pre {
            margin: 0;
            padding: 15px;
            overflow-x: auto;
            background: #2d2d2d;
            height: 100%; /* è®©preå æ®æ•´ä¸ªé«˜åº¦ */
            box-sizing: border-box;
        }
        
        code {
            font-family: 'SF Mono', 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem; /* ç¨å¾®å°ä¸€ç‚¹çš„å­—ä½“ */
            line-height: 1.5;
        }
        
        /* è¯´æ˜åŒºåŸŸ */
        .info {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            margin: 0 10px 15px 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            flex-shrink: 0; /* é˜²æ­¢è¯´æ˜åŒºåŸŸè¢«å‹ç¼© */
        }
        
        /* åˆ†é¡µæŒ‰é’® */
        .tab-buttons {
            display: flex;
            background: rgba(0, 0, 0, 0.05);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .tab-btn.active {
            background: rgba(255, 255, 255, 0.8);
            font-weight: 600;
            color: #4CAF50;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #4CAF50;
        }
        
        /* åˆ†é¡µå†…å®¹ */
        .tab-content {
            padding: 20px;
            max-height: 200px; /* é™åˆ¶è¯´æ˜åŒºåŸŸçš„æœ€å¤§é«˜åº¦ */
            overflow-y: auto;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .info h2 {
            color: #333;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
        }
        
        .info p {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.8;
            margin-bottom: 12px;
        }
        
        .info ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .info li {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.8;
            margin-bottom: 8px;
        }
        
        .info code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', monospace;
            color: #e91e63;
        }
        
        /* æç¤ºæ¡†æ ·å¼ */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 1000;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            h1 {
                font-size: 1rem;
            }
            
            .copy-all-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            code {
                font-size: 0.75rem; /* æ‰‹æœºç«¯æ›´å°å­—ä½“ */
            }
            
            .header, .code-block, .info {
                margin-left: 5px;
                margin-right: 5px;
            }
            
            .tab-btn {
                font-size: 0.8rem;
                padding: 10px 5px;
            }
            
            .info h2 {
                font-size: 1rem;
            }
            
            .info p, .info li {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <div class="header">
            <h1>ğŸ ä»£ç æ–‡ä»¶åˆå¹¶å·¥å…·</h1>
            <button class="copy-all-btn" onclick="copyAll()">ğŸ“‹ å¤åˆ¶å…¨éƒ¨</button>
        </div>
        
        <!-- ä»£ç å±•ç¤ºåŒº - æ‰©å¤§æ˜¾ç¤ºåŒºåŸŸ -->
        <div class="code-block">
            <div class="module-title">
                <span>Pythonè„šæœ¬ï¼šcode_to_json_js.py</span>
            </div>
            <div class="module-code">
                <pre><code class="language-python" id="code-content">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶å: code_to_json_js.py
åŠŸèƒ½: å°†ä»£ç æ–‡ä»¶åˆå¹¶ä¸ºJSONæ ¼å¼çš„JavaScriptæ–‡ä»¶
åˆ›å»ºæ—¶é—´: 2025å¹´12æœˆ
æè¿°: å°†æ‰€æœ‰ä»£ç æ–‡ä»¶åˆå¹¶åˆ°ä¸€ä¸ªJSæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨JSONæ ¼å¼å­˜å‚¨ï¼ŒåŒ…å«å®Œå–„çš„è½¬ä¹‰å¤„ç†
"""

import os
import re
import random
import string
import json
from pathlib import Path
from datetime import datetime

class CodeToJSONJS:
    """ä»£ç æ–‡ä»¶è½¬JSONæ ¼å¼JSè½¬æ¢å™¨"""
    
    def __init__(self):
        # 1. åˆå§‹åŒ–ç±»çš„å±æ€§
        self.directory = ""
        self.user_prefix = ""
        self.supported_extensions = {
            '.txt', '.md', '.py', '.c', '.cpp', '.h', '.hpp', 
            '.java', '.js', '.css', '.html', '.htm', '.json', 
            '.xml', '.yaml', '.yml', '.sh', '.bat', '.sql'
        }
    
    def get_directory(self):
        # 2. è·å–ç”¨æˆ·è¾“å…¥çš„ç›®å½•è·¯å¾„
        default_dir = "/storage/emulated/0/Download/"
        print("=" * 60)
        print(" ä»£ç æ–‡ä»¶åˆå¹¶ä¸ºJSONæ ¼å¼JSå·¥å…·")
        print("=" * 60)
        print(f"\nè¯·è¾“å…¥ä»£ç æ–‡ä»¶æ‰€åœ¨ç›®å½•è·¯å¾„ï¼š")
        print(f"ï¼ˆç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤ç›®å½•: {default_dir}ï¼‰")
        
        while True:
            user_input = input("> ").strip()
            if not user_input:
                self.directory = default_dir
            else:
                self.directory = user_input
            
            if os.path.exists(self.directory):
                print(f"ä½¿ç”¨ç›®å½•: {self.directory}")
                return True
            else:
                print(f"ç›®å½•ä¸å­˜åœ¨: {self.directory}")
                print("è¯·é‡æ–°è¾“å…¥æˆ–æŒ‰Ctrl+Cé€€å‡º")
    
    def get_user_prefix(self):
        # 3. è·å–ç”¨æˆ·è¾“å…¥çš„2ä½å­—æ¯å‰ç¼€
        print("\nè¯·è¾“å…¥2ä½å­—æ¯ä½œä¸ºå˜é‡åå‰ç¼€ï¼ˆä¾‹å¦‚: ab, xy, myç­‰ï¼‰ï¼š")
        while True:
            prefix = input("> ").strip().lower()
            if len(prefix) == 2 and prefix.isalpha():
                self.user_prefix = prefix
                print(f"ä½¿ç”¨å‰ç¼€: {self.user_prefix}")
                return True
            else:
                print("è¯·è¾“å…¥2ä¸ªå­—æ¯ï¼")
    
    def get_code_files(self):
        # 4. è·å–ç›®å½•ä¸‹æ‰€æœ‰æ”¯æŒçš„ä»£ç æ–‡ä»¶
        files = []
        all_files = list(Path(self.directory).glob("*"))
        
        for file_path in all_files:
            if file_path.is_file() and file_path.suffix.lower() in self.supported_extensions:
                files.append(file_path)
        
        # è‡ªç„¶æ’åº
        files.sort(key=lambda x: self.natural_sort_key(x.name))
        return files
    
    def natural_sort_key(self, filename):
        # 5. è‡ªç„¶æ’åºå‡½æ•°
        return [int(text) if text.isdigit() else text.lower() for text in re.split(r'(\d+)', filename)]
    
    def generate_variable_name(self, index):
        # 6. ç”Ÿæˆå˜é‡åï¼šåºå·-ç”¨æˆ·å‰ç¼€+4ä½éšæœºå­—æ¯
        random_letters = ''.join(random.choices(string.ascii_lowercase, k=4))
        return f"{index}-{self.user_prefix}{random_letters}"
    
    def escape_json_string(self, content):
        # 7. æ‰‹åŠ¨è½¬ä¹‰JSONå­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦
        # å…ˆå¤„ç†åæ–œæ ï¼ˆå¿…é¡»ç¬¬ä¸€ä¸ªå¤„ç†ï¼‰
        content = content.replace('\\', '\\\\')
        # å¤„ç†åŒå¼•å·
        content = content.replace('"', '\\"')
        # å¤„ç†æ§åˆ¶å­—ç¬¦
        content = content.replace('\b', '\\b')
        content = content.replace('\f', '\\f')
        content = content.replace('\n', '\\n')
        content = content.replace('\r', '\\r')
        content = content.replace('\t', '\\t')
        
        # å¤„ç†å…¶ä»–å¯èƒ½çš„é—®é¢˜å­—ç¬¦
        result = []
        for char in content:
            char_code = ord(char)
            # ä¿ç•™å¯æ‰“å°å­—ç¬¦å’Œå·²å¤„ç†çš„æ§åˆ¶å­—ç¬¦
            if char_code >= 32 or char in '\n\r\t':
                result.append(char)
            else:
                # å¯¹äºå…¶ä»–æ§åˆ¶å­—ç¬¦ï¼Œä½¿ç”¨Unicodeè½¬ä¹‰
                result.append(f'\\u{char_code:04x}')
        
        return ''.join(result)
    
    def read_file_content(self, file_path):
        # 8. è¯»å–æ–‡ä»¶å†…å®¹
        try:
            # å°è¯•UTF-8ç¼–ç 
            with open(file_path, 'r', encoding='utf-8') as f:
                content = f.read()
            return self.escape_json_string(content)
        except UnicodeDecodeError:
            try:
                # å°è¯•GBKç¼–ç 
                with open(file_path, 'r', encoding='gbk') as f:
                    content = f.read()
                return self.escape_json_string(content)
            except:
                return self.escape_json_string("ã€æ— æ³•è¯»å–æ–‡ä»¶å†…å®¹ï¼šç¼–ç é—®é¢˜ã€‘")
        except Exception as e:
            return self.escape_json_string(f"ã€è¯»å–æ–‡ä»¶å‡ºé”™: {str(e)}ã€‘")
    
    def safe_json_dumps(self, obj):
        # 9. å®‰å…¨çš„JSONåºåˆ—åŒ–ï¼Œå¤„ç†ç‰¹æ®Šå­—ç¬¦
        try:
            # ä½¿ç”¨json.dumpså¹¶è®¾ç½®ensure_ascii=False
            return json.dumps(obj, ensure_ascii=False, indent=2)
        except (TypeError, ValueError) as e:
            print(f"âš ï¸JSONåºåˆ—åŒ–è­¦å‘Š: {e}")
            # å¦‚æœå¤±è´¥ï¼Œå°è¯•æ‰‹åŠ¨å¤„ç†
            if isinstance(obj, dict):
                items = []
                for key, value in obj.items():
                    if isinstance(value, str):
                        value = self.escape_json_string(value)
                    elif isinstance(value, dict):
                        value = self.safe_json_dumps(value)
                        value = value.strip('{}')
                    items.append(f' "{key}": {value}')
                return '{\n' + ',\n'.join(items) + '\n}'
            else:
                return f'"{self.escape_json_string(str(obj))}"'
    
    def convert_to_json_js(self, files):
        # 10. å°†æ–‡ä»¶è½¬æ¢ä¸ºJSONæ ¼å¼çš„JavaScriptæ–‡ä»¶
        output_filename = f"code_files_{self.user_prefix}_{datetime.now().strftime('%Y%m%d_%H%M%S')}.js"
        output_path = os.path.join(self.directory, output_filename)
        
        # åˆ›å»ºJSONæ•°æ®ç»“æ„
        code_files_data = {}
        
        # æ·»åŠ å…ƒæ•°æ®
        metadata = {
            "generated_time": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
            "prefix": self.user_prefix,
            "total_files": len(files),
            "source_directory": self.directory,
            "description": f"ä»£ç æ–‡ä»¶é›†åˆï¼Œå˜é‡åæ ¼å¼: åºå·-{self.user_prefix}XXXX"
        }
        
        # å¤„ç†æ¯ä¸ªæ–‡ä»¶
        for i, file_path in enumerate(files, 1):
            # ç”Ÿæˆå˜é‡å
            var_name = self.generate_variable_name(i)
            
            # è·å–æ–‡ä»¶ä¿¡æ¯
            file_size = file_path.stat().st_size
            mod_time = datetime.fromtimestamp(file_path.stat().st_mtime).strftime('%Y-%m-%d %H:%M:%S')
            
            # è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆå·²åŒ…å«è½¬ä¹‰å¤„ç†ï¼‰
            content = self.read_file_content(file_path)
            print(f"æ­£åœ¨å¤„ç†: {file_path.name} -> {var_name}")
            
            # æ·»åŠ åˆ°JSONæ•°æ®
            code_files_data[var_name] = {
                "filename": file_path.name,
                "content": content,
                "size": file_size,
                "mod_time": mod_time,
                "extension": file_path.suffix.lower(),
                "index": i
            }
        
        try:
            with open(output_path, 'w', encoding='utf-8') as js_file:
                # å†™å…¥æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š
                js_file.write("// ä»£ç æ–‡ä»¶JSONé›†åˆ\n")
                js_file.write(f"// ç”Ÿæˆæ—¶é—´: {metadata['generated_time']}\n")
                js_file.write(f"// å˜é‡å‰ç¼€: {metadata['prefix']}\n")
                js_file.write(f"// æ–‡ä»¶æ•°é‡: {metadata['total_files']}\n")
                js_file.write(f"// æºç›®å½•: {metadata['source_directory']}\n")
                js_file.write(f"// å˜é‡åæ ¼å¼: åºå·-{metadata['prefix']}XXXX\n")
                js_file.write("// æ³¨æ„: æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦å·²è¿›è¡Œè½¬ä¹‰å¤„ç†\n")
                js_file.write("\n")
                
                # å†™å…¥å…ƒæ•°æ®
                js_file.write("// å…ƒæ•°æ®\n")
                metadata_json = self.safe_json_dumps(metadata)
                js_file.write(f"const codeFilesMeta = {metadata_json};\n\n")
                
                # å†™å…¥ä¸»è¦æ•°æ®
                js_file.write("// æ–‡ä»¶æ•°æ®\n")
                js_file.write("const codeFiles = ")
                files_json = self.safe_json_dumps(code_files_data)
                js_file.write(files_json)
                js_file.write(";\n\n")
                
                # å†™å…¥ä¾¿åˆ©å‡½æ•°
                js_file.write("// ä¾¿åˆ©å‡½æ•°\n")
                js_file.write("// è·å–æ‰€æœ‰å˜é‡å\n")
                js_file.write("function getAllVariableNames() {\n")
                js_file.write("    return Object.keys(codeFiles);\n")
                js_file.write("}\n\n")
                
                js_file.write("// æ ¹æ®ç´¢å¼•è·å–å˜é‡å\n")
                js_file.write("function getVariableNameByIndex(index) {\n")
                js_file.write("    const names = Object.keys(codeFiles);\n")
                js_file.write("    return names[index - 1] || null;\n")
                js_file.write("}\n\n")
                
                js_file.write("// è·å–æ–‡ä»¶å†…å®¹\n")
                js_file.write("function getFileContent(variableName) {\n")
                js_file.write("    const file = codeFiles[variableName];\n")
                js_file.write("    return file ? file.content : null;\n")
                js_file.write("}\n\n")
                
                js_file.write("// è·å–æ–‡ä»¶ä¿¡æ¯\n")
                js_file.write("function getFileInfo(variableName) {\n")
                js_file.write("    return codeFiles[variableName] || null;\n")
                js_file.write("}\n\n")
                
                js_file.write("// æ ¹æ®ç´¢å¼•è·å–æ–‡ä»¶ä¿¡æ¯\n")
                js_file.write("function getFileInfoByIndex(index) {\n")
                js_file.write("    const varName = getVariableNameByIndex(index);\n")
                js_file.write("    return varName ? getFileInfo(varName) : null;\n")
                js_file.write("}\n\n")
                
                js_file.write("// è·å–æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨\n")
                js_file.write("function getAllFilesList() {\n")
                js_file.write("    return Object.keys(codeFiles).map(varName => ({\n")
                js_file.write("        variableName: varName,\n")
                js_file.write("        ...codeFiles[varName]\n")
                js_file.write("    }));\n")
                js_file.write("}\n\n")
                
                js_file.write("// æœç´¢æ–‡ä»¶\n")
                js_file.write("function searchFiles(keyword) {\n")
                js_file.write("    const results = [];\n")
                js_file.write("    for (const [varName, file] of Object.entries(codeFiles)) {\n")
                js_file.write("        if (file.filename.toLowerCase().includes(keyword.toLowerCase()) ||\n")
                js_file.write("            file.content.toLowerCase().includes(keyword.toLowerCase())) {\n")
                js_file.write("            results.push({ variableName: varName, ...file });\n")
                js_file.write("        }\n")
                js_file.write("    }\n")
                js_file.write("    return results;\n")
                js_file.write("}\n\n")
                
                # æ·»åŠ å†…å®¹åè½¬ä¹‰å‡½æ•°
                js_file.write("// åè½¬ä¹‰å‡½æ•°ï¼ˆç”¨äºæ˜¾ç¤ºï¼‰\n")
                js_file.write("function unescapeContent(content) {\n")
                js_file.write("    return content\n")
                js_file.write("        .replace(/\\\\/g, '\\\\')\n")
                js_file.write("        .replace(/\\\"/g, '\"')\n")
                js_file.write("        .replace(/\\\\b/g, '\\b')\n")
                js_file.write("        .replace(/\\\\f/g, '\\f')\n")
                js_file.write("        .replace(/\\\\n/g, '\\n')\n")
                js_file.write("        .replace(/\\\\r/g, '\\r')\n")
                js_file.write("        .replace(/\\\\t/g, '\\t');\n")
                js_file.write("}\n\n")
                
                js_file.write("// è·å–åè½¬ä¹‰çš„æ–‡ä»¶å†…å®¹\n")
                js_file.write("function getFileContentUnescaped(variableName) {\n")
                js_file.write("    const content = getFileContent(variableName);\n")
                js_file.write("    return content ? unescapeContent(content) : null;\n")
                js_file.write("}\n")
            
            return output_path, len(files)
        
        except Exception as e:
            print(f"ç”ŸæˆJSæ–‡ä»¶æ—¶å‡ºé”™: {e}")
            return None, 0
    
    def run(self):
        # 11. è¿è¡Œè½¬æ¢å™¨
        # è·å–ç›®å½•
        if not self.get_directory():
            return
        
        # è·å–ç”¨æˆ·å‰ç¼€
        if not self.get_user_prefix():
            return
        
        # è·å–æ–‡ä»¶åˆ—è¡¨
        files = self.get_code_files()
        if not files:
            print("æœªæ‰¾åˆ°ä»»ä½•æ”¯æŒçš„ä»£ç æ–‡ä»¶ï¼")
            print(f"æ”¯æŒçš„æ–‡ä»¶ç±»å‹: {', '.join(sorted(self.supported_extensions))}")
            return
        
        print(f"\nğŸ“æ‰¾åˆ°{len(files)}ä¸ªæ”¯æŒçš„æ–‡ä»¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºå¤„ç†ï¼š")
        for i, f in enumerate(files, 1):
            print(f" {i:2d}. {f.name}")
        
        # è½¬æ¢ä¸ºJSONæ ¼å¼JS
        print(f"\nğŸ”„å¼€å§‹åˆå¹¶ä¸ºJSONæ ¼å¼JavaScriptæ–‡ä»¶...")
        print("âš ï¸æ­£åœ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰...")
        js_path, file_count = self.convert_to_json_js(files)
        
        if js_path and file_count > 0:
            # æ˜¾ç¤ºç»“æœ
            js_size = os.path.getsize(js_path)
            print(f"\nğŸ‰åˆå¹¶å®Œæˆï¼")
            print(f"ğŸ“„JavaScriptæ–‡ä»¶: {js_path}")
            print(f"ğŸ“Šå¤„ç†æ–‡ä»¶æ•°: {file_count}")
            print(f"ğŸ’¾æ–‡ä»¶å¤§å°: {js_size}å­—èŠ‚")
            print(f"\nğŸ“å˜é‡åç¤ºä¾‹: 1-{self.user_prefix}xxxx, 2-{self.user_prefix}xxxx, ...")
            print(f"ğŸ“ä½¿ç”¨æ–¹æ³•: codeFiles['1-{self.user_prefix}xxxx'].content è·å–å†…å®¹")
            print(f"ğŸ“ä½¿ç”¨æ–¹æ³•: getFileContent('1-{self.user_prefix}xxxx') è·å–å†…å®¹")
            print(f"ğŸ“ä½¿ç”¨æ–¹æ³•: getFileContentUnescaped('1-{self.user_prefix}xxxx') è·å–åè½¬ä¹‰å†…å®¹")
            print(f"ğŸ“ä½¿ç”¨æ–¹æ³•: getFileInfoByIndex(1) è·å–ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¿¡æ¯")
            
            # æ˜¾ç¤ºå‰å‡ ä¸ªå˜é‡åç¤ºä¾‹
            print(f"\nğŸ”ç”Ÿæˆçš„å˜é‡åç¤ºä¾‹:")
            for i in range(min(3, file_count)):
                random_letters = ''.join(random.choices(string.ascii_lowercase, k=4))
                example_var = f"{i+1}-{self.user_prefix}{random_letters}"
                print(f" {example_var}")
            
            print(f"\næ‰€æœ‰ç‰¹æ®Šå­—ç¬¦å·²è½¬ä¹‰ï¼Œå¯å®‰å…¨ä½¿ç”¨ï¼")
        else:
            print("âŒåˆå¹¶å¤±è´¥ï¼")

def main():
    # 12. ä¸»å‡½æ•°
    converter = CodeToJSONJS()
    converter.run()
    print("\nä»»åŠ¡å·²å®Œæˆï¼")

if __name__ == "__main__":
    main()
</code></pre>
            </div>
        </div>
        
        <!-- è¯´æ˜åŒºåŸŸ -->
        <div class="info">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="design">è®¾è®¡æ€è·¯</button>
                <button class="tab-btn" data-tab="api">å‡½æ•°æ¥å£</button>
            </div>
            
            <div class="tab-content">
                <!-- è®¾è®¡æ€è·¯ -->
                <div class="tab-pane active" id="design">
                    <h2>ğŸ¯ è®¾è®¡æ€è·¯</h2>
                    <p>è¿™ä¸ªå·¥å…·çš„æ ¸å¿ƒç›®æ ‡æ˜¯<strong>å°†å¤šä¸ªä»£ç æ–‡ä»¶åˆå¹¶ä¸ºå•ä¸ªJSæ–‡ä»¶</strong>ï¼Œä¾¿äºå‰ç«¯ç›´æ¥è®¿é—®æ–‡ä»¶å†…å®¹è€Œæ— éœ€æœåŠ¡å™¨ã€‚ä»¥ä¸‹æ˜¯å…³é”®è®¾è®¡ç‚¹ï¼š</p>
                    
                    <ul>
                        <li><strong>å˜é‡å‘½åç­–ç•¥</strong>ï¼šé‡‡ç”¨"åºå·-å‰ç¼€+éšæœºå­—æ¯"æ ¼å¼ï¼ˆå¦‚1-abXy9ï¼‰ï¼Œç¡®ä¿å”¯ä¸€æ€§åŒæ—¶ä¿æŒå¯è¯»æ€§</li>
                        <li><strong>å®‰å…¨è½¬ä¹‰å¤„ç†</strong>ï¼šå®ç°å®Œå–„çš„JSONè½¬ä¹‰æœºåˆ¶ï¼Œå¤„ç†ç‰¹æ®Šå­—ç¬¦ã€æ§åˆ¶å­—ç¬¦å’ŒUnicodeå­—ç¬¦</li>
                        <li><strong>ç¼–ç å…¼å®¹æ€§</strong>ï¼šè‡ªåŠ¨æ£€æµ‹UTF-8/GBKç¼–ç ï¼Œè§£å†³ä¸­æ–‡æ–‡ä»¶å†…å®¹è¯»å–é—®é¢˜</li>
                        <li><strong>è‡ªç„¶æ’åº</strong>ï¼šæ–‡ä»¶æŒ‰åç§°è‡ªç„¶æ’åºï¼ˆå¦‚file1.txt, file2.txt, file10.txtï¼‰</li>
                        <li><strong>å…ƒæ•°æ®ç®¡ç†</strong>ï¼šåŒ…å«ç”Ÿæˆæ—¶é—´ã€æ–‡ä»¶ç»Ÿè®¡ç­‰å…ƒæ•°æ®ï¼Œä¾¿äºè¿½è¸ª</li>
                    </ul>
                    
                    <p>æœ€ç»ˆç”Ÿæˆçš„JSæ–‡ä»¶åŒ…å«<strong>åŸå§‹æ•°æ®+ä¾¿åˆ©å‡½æ•°</strong>ï¼Œå‰ç«¯å¯ç›´æ¥é€šè¿‡<code>getFileContent('å˜é‡å')</code>è·å–å†…å®¹ï¼Œå®ç°çœŸæ­£çš„é™æ€æ–‡ä»¶è®¿é—®ã€‚</p>
                </div>
                
                <!-- å‡½æ•°æ¥å£ -->
                <div class="tab-pane" id="api">
                    <h2>ğŸ”§ å‡½æ•°æ¥å£</h2>
                    <p>ç”Ÿæˆçš„JSæ–‡ä»¶æä¾›ä»¥ä¸‹ä¾¿åˆ©å‡½æ•°ï¼š</p>
                    
                    <ul>
                        <li><code>getAllVariableNames()</code> - è·å–æ‰€æœ‰å˜é‡åæ•°ç»„</li>
                        <li><code>getVariableNameByIndex(index)</code> - æ ¹æ®åºå·è·å–å˜é‡åï¼ˆä»1å¼€å§‹ï¼‰</li>
                        <li><code>getFileContent(variableName)</code> - è·å–æ–‡ä»¶åŸå§‹å†…å®¹ï¼ˆå·²è½¬ä¹‰ï¼‰</li>
                        <li><code>getFileContentUnescaped(variableName)</code> - è·å–åè½¬ä¹‰åçš„å¯è¯»å†…å®¹</li>
                        <li><code>getFileInfo(variableName)</code> - è·å–å®Œæ•´æ–‡ä»¶ä¿¡æ¯ï¼ˆå«å…ƒæ•°æ®ï¼‰</li>
                        <li><code>getFileInfoByIndex(index)</code> - æ ¹æ®åºå·è·å–æ–‡ä»¶ä¿¡æ¯</li>
                        <li><code>getAllFilesList()</code> - è·å–æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯åˆ—è¡¨</li>
                        <li><code>searchFiles(keyword)</code> - æœç´¢æ–‡ä»¶åæˆ–å†…å®¹åŒ…å«å…³é”®è¯çš„æ–‡ä»¶</li>
                    </ul>
                    
                    <p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
                    <pre><code class="language-javascript">// è·å–ç¬¬ä¸€ä¸ªæ–‡ä»¶å†…å®¹
const firstFile = getFileInfoByIndex(1);
console.log(firstFile.filename);

// æœç´¢åŒ…å«"config"çš„æ–‡ä»¶
const configs = searchFiles('config');

// è·å–åè½¬ä¹‰å†…å®¹
const content = getFileContentUnescaped('1-abXy9');
document.body.innerHTML = `<pre>${content}</pre>`;</code></pre>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æç¤ºæ¡† -->
    <div class="toast" id="toast">å·²å¤åˆ¶</div>
    
    <script>
        // 1. åˆå§‹åŒ–ä»£ç é«˜äº®
        document.addEventListener('DOMContentLoaded', function() {
            Prism.highlightAll();
            
            // 2. åˆ†é¡µåˆ‡æ¢åŠŸèƒ½
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabPanes = document.querySelectorAll('.tab-pane');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    tabBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // æ›´æ–°å†…å®¹æ˜¾ç¤º
                    tabPanes.forEach(pane => {
                        pane.classList.remove('active');
                        if (pane.id === targetTab) {
                            pane.classList.add('active');
                        }
                    });
                });
            });
        });
        
        // 3. å¤åˆ¶å…¨éƒ¨ä»£ç  - åŸå°ä¸åŠ¨å¤åˆ¶
        function copyAll() {
            const codeContent = document.getElementById('code-content').textContent;
            navigator.clipboard.writeText(codeContent).then(() => {
                showToast();
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
            });
        }
        
        // 4. æ˜¾ç¤ºæç¤ºæ¡†
        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 1500);
        }
    </script>
</body>
</html>
