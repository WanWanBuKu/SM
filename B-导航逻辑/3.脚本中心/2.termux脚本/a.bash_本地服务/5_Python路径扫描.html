<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python ä»£ç æŸ¥çœ‹å™¨</title>
    
        <!-- prism.js è¯­æ³•é«˜äº®   -->
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/1.prism-css-ç™½è‰²ä¸»é¢˜.js"></script>   
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-core.min.js"></script>    <!-- æ ¸å¿ƒæ–‡ä»¶ -->
      <script src="/A2_å…¨å±€ä¸­å¿ƒ/B_æ’ä»¶ç¼“å­˜-CDN/1.prismä»£ç é«˜äº®/prism-python.min.js"></script>   
    
    <style>
        /* 1. åŸºç¡€æ ·å¼é‡ç½® */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* 2. é¡µé¢ä¸»ä½“æ ·å¼ */
        body { 
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace; 
            background: #ffffff; 
            color: #2c3e50; 
            line-height: 1.6; 
            padding: 0;
            height: 100vh;
            overflow: hidden;
        }
        
        /* 3. ä»£ç å®¹å™¨ */
        .code-container { 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
        }
        
        /* 4. ä»£ç å¤´éƒ¨ - å‡å°‘padding */
        .code-header { 
            background: linear-gradient(90deg, #f8f9fa 0%, #e9ecef 100%); 
            padding: 8px 12px; 
            border-bottom: 1px solid #dee2e6; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            flex-shrink: 0;
        }
        
        /* 5. ä»£ç æ ‡é¢˜ - å‡å°å­—ä½“ */
        .code-title { 
            color: #6c757d; 
            font-size: 12px; 
            font-weight: 600; 
            letter-spacing: 0.5px; 
        }
        
        /* 6. æŒ‰é’®ç»„ */
        .button-group {
            display: flex;
            gap: 6px;
        }
        
        /* 7. å¤åˆ¶æŒ‰é’® - å‡å°padding */
        .copy-btn { 
            color: white; 
            border: none; 
            padding: 4px 10px; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 11px; 
            font-weight: 600; 
            transition: all 0.3s ease; 
            display: flex; 
            align-items: center; 
            gap: 4px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            box-shadow: 0 2px 4px rgba(118, 75, 162, 0.3); 
        }
        
        /* 8. å¤åˆ¶æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .copy-btn:hover { 
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); 
            transform: scale(1.05); 
        }
        
        /* 9. ä»£ç å†…å®¹åŒºåŸŸ - å‡å°‘padding */
        .code-content { 
            flex: 1; 
            overflow: auto; 
            background: #f8f9fa; 
            padding: 10px; 
        }
        
        /* 10. ä»£ç å—æ ·å¼ - å‡å°å­—ä½“ */
        pre { 
            margin: 0; 
            padding: 0; 
            background: transparent; 
            font-size: 12px; 
            line-height: 1.4; 
        }
        
        /* 11. ä»£ç æ ·å¼ */
        code { 
            font-family: inherit; 
            white-space: pre; 
        }
    </style>
</head>
<body>
    <div class="code-container">
        <div class="code-header">
            <span class="code-title">scan.py</span>
            <div class="button-group">
                <button class="copy-btn" onclick="copyCode()">
                    <span>ğŸ“‹</span>
                    <span>å¤åˆ¶</span>
                </button>
            </div>
        </div>
        <div class="code-content">
            <pre><code class="language-python">#!/data/data/com.termux/files/usr/bin/env python3
# 1. è„šæœ¬åç§°ï¼šscan.py â€”â€” Termux äº¤äº’å¼ç›®å½•å±‚çº§æ‰«æå™¨ï¼ˆPython ç‰ˆï¼‰
# 2. ä¾èµ–ï¼šä»…å†…ç½®åº“ï¼Œæ— éœ€é¢å¤–å®‰è£…

# 3. å¯¼å…¥æ‰€éœ€æ ‡å‡†åº“
import os
import sys
from pathlib import Path

# 4. å½©è‰²è¾“å‡ºå·¥å…·ï¼ˆè·¨å¹³å°ï¼‰
def color(text: str, code: int) -> str:
    """ç»™æ–‡æœ¬åŠ  ANSI é¢œè‰²ç ï¼Œå¤±è´¥æ—¶è¿”å›åŸæ–‡æœ¬"""
    return f"\033[{code}m{text}\033[0m" if sys.stdout.isatty() else text

red    = lambda t: color(t, 31)
green  = lambda t: color(t, 32)
yellow = lambda t: color(t, 33)

# 5. é€’å½’æ‰“å°ç›®å½•æ ‘ï¼Œæ”¯æŒå±‚çº§é™åˆ¶
def tree(path: Path, prefix: str = "", depth_left: int = None) -> None:
    """
    é€’å½’æ‰“å°ç›®å½•æ ‘
    :param path:        å½“å‰è¦æ‰«æçš„è·¯å¾„ï¼ˆPath å¯¹è±¡ï¼‰
    :param prefix:      å‰ç¼€å­—ç¬¦ä¸²ï¼Œç”¨äºå¯¹é½æ ‘çŠ¶ç»“æ„
    :param depth_left:  å‰©ä½™å¯é€’å½’æ·±åº¦ï¼ŒNone=æ— é™
    """
    if depth_left is not None and depth_left < 0:
        return

    entries = sorted(path.iterdir(), key=lambda p: (p.is_file(), p.name.lower()))
    pointers = ["â”œâ”€â”€ "] * (len(entries) - 1) + ["â””â”€â”€ "] if entries else []
    for pointer, entry in zip(pointers, entries):
        print(prefix + pointer + (red(entry.name) if entry.is_dir() else entry.name))
        if entry.is_dir():
            extension = "â”‚   " if pointer == "â”œâ”€â”€ " else "    "
            tree(entry, prefix + extension,
                 depth_left if depth_left is None else depth_left - 1)

# 6. ä¸»é€»è¾‘å‡½æ•°
def main() -> None:
    try:
        print(yellow("\n=== Termux ç›®å½•æ‰«æå™¨ (Python) ==="))
        # 7. è¯»å–å¾…æ‰«æç›®å½•
        target = input("è¯·è¾“å…¥æƒ³è¦æ‰«æçš„ç›®å½•ï¼ˆç»å¯¹æˆ–ç›¸å¯¹è·¯å¾„ï¼‰: ").strip()
        target_path = Path(target).expanduser().resolve()
        if not target_path.exists():
            print(red(f"é”™è¯¯ï¼šè·¯å¾„ä¸å­˜åœ¨ â†’ {target_path}"))
            return
        if not target_path.is_dir():
            print(red(f"é”™è¯¯ï¼šè·¯å¾„ä¸æ˜¯ç›®å½• â†’ {target_path}"))
            return

        # 8. è¯»å–å±‚çº§
        depth_input = input("è¯·é€‰æ‹©æ‰«æå±‚çº§ï¼ˆæ•°å­—ï¼Œç›´æ¥å›è½¦=å…¨éƒ¨å±‚çº§ï¼‰: ").strip()
        depth = None
        if depth_input:
            if not depth_input.isdigit() or int(depth_input) < 0:
                print(red("é”™è¯¯ï¼šå±‚çº§å¿…é¡»æ˜¯â‰¥0çš„æ•´æ•°"))
                return
            depth = int(depth_input)

        # 9. æ‰§è¡Œæ‰«æ
        print(green("\næ‰«æç»“æœï¼š"))
        print("-" * 40)
        tree(target_path, depth_left=depth)
        print("-" * 40)
    except KeyboardInterrupt:
        print(yellow("\nç”¨æˆ·ä¸­æ–­ï¼Œå·²é€€å‡ºã€‚"))
    except Exception as e:
        print(red(f"æœªçŸ¥å¼‚å¸¸ï¼š{e}"))

# 10. å…¥å£ä¿æŠ¤
if __name__ == "__main__":
    main()</code></pre>
        </div>
    </div>

    <script>
        // 1. é¡µé¢åŠ è½½å®Œæˆååº”ç”¨è¯­æ³•é«˜äº®
        document.addEventListener('DOMContentLoaded', function() {
            Prism.highlightAll();
        });
        
        // 2. å¤åˆ¶ä»£ç ï¼ˆåªå¤åˆ¶è„šæœ¬å†…å®¹ï¼‰
        function copyCode() {
            // ç²¾ç¡®é€‰æ‹©ä»£ç å†…å®¹ï¼Œæ’é™¤HTMLæ ‡ç­¾
            const codeElement = document.querySelector('code.language-python');
            if (!codeElement) {
                console.error('æœªæ‰¾åˆ°ä»£ç å…ƒç´ ');
                return;
            }
            
            // è·å–çº¯æ–‡æœ¬å†…å®¹ï¼Œå»é™¤å¯èƒ½çš„HTMLå®ä½“
            let codeContent = codeElement.textContent || codeElement.innerText;
            
            // æ¸…ç†å†…å®¹ï¼šå»é™¤å‰åç©ºç™½ï¼Œä½†ä¿ç•™å†…éƒ¨æ ¼å¼
            codeContent = codeContent.trim();
            
            // è°ƒè¯•ä¿¡æ¯
            console.log('å¤åˆ¶çš„ä»£ç é•¿åº¦:', codeContent.length);
            console.log('å¤åˆ¶çš„å‰50ä¸ªå­—ç¬¦:', codeContent.substring(0, 50));
            
            // ç›´æ¥åœ¨å½“å‰é¡µé¢å¤åˆ¶ï¼Œä¸é€šè¿‡çˆ¶é¡µé¢
            navigator.clipboard.writeText(codeContent).then(() => {
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showCopySuccess();
                
                // åŒæ—¶é€šçŸ¥çˆ¶é¡µé¢ï¼ˆå¯é€‰ï¼‰
                window.parent.postMessage({
                    type: 'copySuccess',
                    content: 'ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'
                }, '*');
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                // é™çº§æ–¹æ¡ˆï¼šåˆ›å»ºä¸´æ—¶æ–‡æœ¬åŒºåŸŸ
                fallbackCopy(codeContent);
            });
        }
        
        // 3. é™çº§å¤åˆ¶æ–¹æ¡ˆ
        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess();
                }
            } catch (err) {
                console.error('é™çº§å¤åˆ¶å¤±è´¥:', err);
            }
            
            document.body.removeChild(textArea);
        }
        
        // 4. æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
        function showCopySuccess() {
            // åˆ›å»ºæç¤ºå…ƒç´ 
            const toast = document.createElement('div');
            toast.textContent = 'âœ… ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
            toast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(40, 167, 69, 0.9);
                color: white;
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 12px;
                z-index: 1000;
                pointer-events: none;
            `;
            
            document.body.appendChild(toast);
            
            // 1.5ç§’åç§»é™¤æç¤º
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 1500);
        }
        
        // 5. ç›‘å¬æ¥è‡ªä¸»é¡µé¢çš„ç¼©æ”¾æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.data.type === 'zoom') {
                // åº”ç”¨ç¼©æ”¾åˆ°iframeå†…éƒ¨
                applyIframeZoom(event.data.zoomLevel);
            }
        });

        // 6. åº”ç”¨iframeå†…éƒ¨ç¼©æ”¾
        function applyIframeZoom(zoomLevel) {
            const root = document.documentElement;
            root.style.fontSize = `${zoomLevel / 100}rem`;
            
            // ç‰¹æ®Šå¤„ç†ä»£ç å—
            const codeElements = document.querySelectorAll('pre, code');
            codeElements.forEach(element => {
                element.style.fontSize = `${zoomLevel / 100}rem`;
            });
            
            console.log(`iframeç¼©æ”¾å·²åº”ç”¨åˆ°: ${zoomLevel}%`);
        }

        // 7. é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åº”ç”¨è¯­æ³•é«˜äº®
            Prism.highlightAll();
            
            // é€šçŸ¥ä¸»é¡µé¢iframeå·²å‡†å¤‡å¥½æ¥æ”¶ç¼©æ”¾æ¶ˆæ¯
            window.parent.postMessage({
                type: 'iframeReady'
            }, '*');
        });
    </script>
</body>
</html>
