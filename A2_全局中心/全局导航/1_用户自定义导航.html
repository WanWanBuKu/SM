<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¯¼èˆªç®¡ç†ç³»ç»Ÿ</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: #f5f5f5;
    min-height: 100vh;
    color: #333;
    width: 100vw;
    overflow-x: hidden;
}

.container {
    width: 100vw;
    min-height: 100vh;
    padding: 10px;
}

header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 10px;
    gap: 10px;
}

.header-btn {
    padding: 10px 20px;
    border-radius: 8px;
    background: white;
    border: 1px solid #e0e0e0;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    color: #333;
    font-weight: 500;
}

.header-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    background: #f8f8f8;
}

main {
    padding: 10px 0;
}

.saved-navs {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
    width: 100%;
}

.saved-navs h2 {
    color: #333;
    margin-bottom: 20px;
    font-size: 20px;
    font-weight: 600;
}

.nav-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 10px;
    margin-top: 15px;
    width: 100%;
}

/* æ‰‹æœºç«–å±é€‚é… */
@media (max-width: 768px) and (orientation: portrait) {
    .container {
        padding: 5px;
    }
    
    .nav-grid {
        grid-template-columns: repeat(5, 1fr);
        gap: 5px;
    }
    
    .nav-item {
        padding: 8px 2px !important;
        border-radius: 6px !important;
    }
    
    .nav-item .icon {
        font-size: 20px !important;
        margin-bottom: 2px !important;
    }
    
    .nav-item .name {
        font-size: 10px !important;
        line-height: 1.1 !important;
    }
    
    .saved-navs {
        padding: 15px 10px;
        border-radius: 8px;
    }
    
    header {
        padding: 5px;
    }
    
    .header-btn {
        padding: 8px 15px;
        font-size: 12px;
    }
}

.nav-item {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 12px 4px;
    cursor: pointer;
    text-align: center;
    aspect-ratio: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    width: 100%;
    height: 100%;
}

.nav-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    background: #fff;
    border-color: #007bff;
}

.nav-item .icon {
    font-size: 28px;
    margin-bottom: 6px;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    color: #007bff;
}

.nav-item .name {
    color: #333;
    font-size: 11px;
    font-weight: 500;
    line-height: 1.2;
    width: 100%;
    text-align: center;
    word-break: break-all;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #999;
}

.empty-state h3 {
    font-size: 18px;
    margin-bottom: 10px;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    background-color: white;
    margin: 2% auto;
    padding: 0;
    border-radius: 12px;
    width: 95%;
    max-width: 1200px;
    max-height: 96vh;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

.modal-header {
    background: white;
    color: #333;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #e9ecef;
}

.modal-header h2 {
    font-size: 20px;
    font-weight: 600;
}

.close {
    color: #999;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.close:hover {
    background: #f5f5f5;
    color: #333;
}

.modal-body {
    padding: 20px;
    max-height: calc(96vh - 140px);
    overflow-y: auto;
    width: 100%;
}

.config-page-nav {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.config-page-btn {
    padding: 10px 20px;
    background: white;
    color: #333;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
}

.config-page-btn:hover {
    background: #007bff;
    color: white;
    border-color: #007bff;
}

.config-page-btn.active {
    background: #007bff;
    color: white;
    border-color: #007bff;
}

.category-section {
    margin-bottom: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
}

.category-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
}

.subcategory-section {
    margin-bottom: 15px;
    background: white;
    border-radius: 6px;
    padding: 12px;
}

.subcategory-title {
    font-size: 14px;
    font-weight: 500;
    color: #666;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e9ecef;
}

.config-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 10px;
    width: 100%;
}

/* æ‰‹æœºç«–å±é…ç½®ç½‘æ ¼é€‚é… */
@media (max-width: 768px) and (orientation: portrait) {
    .config-grid {
        grid-template-columns: repeat(5, 1fr);
        gap: 5px;
    }
    
    .config-item {
        padding: 8px 2px !important;
        border-radius: 6px !important;
    }
    
    .config-item .icon {
        font-size: 18px !important;
        margin-bottom: 2px !important;
    }
    
    .config-item .name {
        font-size: 9px !important;
        line-height: 1.1 !important;
    }
    
    .config-page-nav {
        padding: 10px 5px;
        gap: 5px;
    }
    
    .config-page-btn {
        padding: 8px 12px;
        font-size: 12px;
    }
    
    .category-section {
        padding: 10px 5px;
        margin-bottom: 10px;
    }
    
    .subcategory-section {
        padding: 8px 5px;
        margin-bottom: 8px;
    }
    
    .modal-body {
        padding: 10px 5px;
    }
}

.config-item {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 12px 4px;
    cursor: pointer;
    text-align: center;
    aspect-ratio: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    width: 100%;
    height: 100%;
    position: relative;
}

.config-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    background: #fff;
    border-color: #28a745;
}

.config-item .icon {
    font-size: 24px;
    margin-bottom: 6px;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    color: #28a745;
}

.config-item .name {
    color: #333;
    font-size: 10px;
    font-weight: 500;
    line-height: 1.2;
    width: 100%;
    text-align: center;
    word-break: break-all;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: #28a745;
    color: white;
    padding: 12px 24px;
    border-radius: 50px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 2000;
    font-size: 14px;
    font-weight: 500;
}

.toast.show {
    opacity: 1;
}

.toast.warning {
    background: #ffc107;
    color: #333;
}
</style>
</head>
<body>
<div class="container">
    <header>
        <button class="header-btn" id="addBtn">æ·»åŠ å¯¼èˆª</button>
        <button class="header-btn" id="resetBtn">é‡ç½®</button>
    </header>
    <main>
        <section class="saved-navs">
            <h2>ğŸ“ æˆ‘çš„å¯¼èˆª</h2>
            <div id="savedNavsContainer" class="nav-grid">
                <!-- åŠ¨æ€ç”Ÿæˆå·²ä¿å­˜çš„å¯¼èˆªé¡¹ -->
            </div>
            <div id="emptyState" class="empty-state" style="display: none;">
                <h3>æš‚æ— ä¿å­˜çš„å¯¼èˆª</h3>
                <p>ç‚¹å‡»å³ä¸Šè§’"æ·»åŠ å¯¼èˆª"æŒ‰é’®æ·»åŠ å¯¼èˆª</p>
            </div>
        </section>
    </main>
</div>

<!-- é…ç½®å¼¹çª— -->
<div id="configModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ğŸ”§ å¯¼èˆªé…ç½®</h2>
            <span class="close">&times;</span>
        </div>
        <!-- æ§åˆ¶é¢æ¿åˆ†é¡µå¯¼èˆª -->
        <div class="config-page-nav" id="configPageNav">
            <button class="config-page-btn active" data-page="0">å·¥å…·å¯¼èˆª</button>
            <button class="config-page-btn" data-page="1">æœç´¢å¯¼èˆª</button>
            <button class="config-page-btn" data-page="2">è„šæœ¬å¯¼èˆª</button>
        </div>
        <div class="modal-body" id="configList">
            <!-- åŠ¨æ€ç”Ÿæˆåˆ†ç±»é…ç½® -->
        </div>
    </div>
</div>

<!-- Toast æç¤º -->
<div id="toast" class="toast"></div>

<script>
let navConfig = {};
let categorizedConfig = {};
let savedNavs = [];
let currentConfigPage = 0;
const mainCategories = ["1.å·¥å…·å¯¼èˆª", "2.èµ„æºæŸ¥æ‰¾", "3.è„šæœ¬ä¸­å¿ƒ"];

function loadConfig() {
    const script = document.createElement('script');
    script.src = './1_nav.config.js';
    script.onload = function() {
        navConfig = window.navConfig;
        categorizeConfig();
        loadSavedNavs();
        renderSavedNavs();
        renderConfigList();
    };
    document.head.appendChild(script);
}

function categorizeConfig() {
    categorizedConfig = {};
    for (const key in navConfig) {
        if (Array.isArray(navConfig[key])) {
            const pathParts = key.split('/');
            const mainCategory = pathParts[0];
            const subCategory = pathParts[1] || 'é»˜è®¤';
            
            if (!categorizedConfig[mainCategory]) {
                categorizedConfig[mainCategory] = {};
            }
            
            if (!categorizedConfig[mainCategory][subCategory]) {
                categorizedConfig[mainCategory][subCategory] = [];
            }
            
            navConfig[key].forEach(item => {
                categorizedConfig[mainCategory][subCategory].push(item);
            });
        }
    }
}

function loadSavedNavs() {
    const saved = localStorage.getItem('savedNavs');
    if (saved) {
        savedNavs = JSON.parse(saved);
    }
}

function saveNav(item) {
    if (savedNavs.some(nav => nav.file === item.file)) {
        showToast('è¯¥å¯¼èˆªå·²å­˜åœ¨ï¼', 'warning');
        return;
    }
    
    savedNavs.push(item);
    localStorage.setItem('savedNavs', JSON.stringify(savedNavs));
    showToast(`å·²ä¿å­˜ï¼š${item.name}`);
    renderSavedNavs();
}

function resetNavs() {
    if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰å¯¼èˆªå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
        localStorage.removeItem('savedNavs');
        savedNavs = [];
        renderSavedNavs();
        showToast('å¯¼èˆªå·²é‡ç½®ï¼');
    }
}

function renderSavedNavs() {
    const container = document.getElementById('savedNavsContainer');
    const emptyState = document.getElementById('emptyState');
    
    if (savedNavs.length === 0) {
        container.style.display = 'none';
        emptyState.style.display = 'block';
        return;
    }
    
    container.style.display = 'grid';
    emptyState.style.display = 'none';
    
    container.innerHTML = savedNavs.map(item => `
        <div class="nav-item" onclick="window.open('${item.file}', '_blank')">
            <div class="icon">${item.icon}</div>
            <div class="name">${item.name}</div>
        </div>
    `).join('');
}

function renderConfigList() {
    const configList = document.getElementById('configList');
    const currentCategory = mainCategories[currentConfigPage];
    let html = '';
    
    if (categorizedConfig[currentCategory]) {
        html += `
            <div class="category-section">
                <div class="category-title">ğŸ“ ${currentCategory.substring(2)}</div>
        `;
        
        for (const subCategory in categorizedConfig[currentCategory]) {
            const items = categorizedConfig[currentCategory][subCategory];
            html += `
                <div class="subcategory-section">
                    <div class="subcategory-title">ğŸ“‚ ${subCategory}</div>
                    <div class="config-grid">
            `;
            
            items.forEach(item => {
                html += `
                    <div class="config-item" onclick="saveNav(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                        <div class="icon">${item.icon}</div>
                        <div class="name">${item.name}</div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
        }
        
        html += `</div>`;
    }
    
    configList.innerHTML = html;
}

function switchConfigPage(pageIndex) {
    currentConfigPage = pageIndex;
    const pageButtons = document.querySelectorAll('.config-page-btn');
    
    // æ›´æ–°æŒ‰é’®çŠ¶æ€
    pageButtons.forEach((btn, index) => {
        if (index === pageIndex) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
    
    // é‡æ–°æ¸²æŸ“é…ç½®åˆ—è¡¨
    renderConfigList();
}

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = 'toast show';
    if (type === 'warning') {
        toast.classList.add('warning');
    }
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

function initEvents() {
    // æ·»åŠ å¯¼èˆªæŒ‰é’®äº‹ä»¶ - è·³è½¬åˆ°æ§åˆ¶é¢æ¿
    document.getElementById('addBtn').addEventListener('click', function() {
        document.getElementById('configModal').style.display = 'block';
    });
    
    // é‡ç½®æŒ‰é’®äº‹ä»¶
    document.getElementById('resetBtn').addEventListener('click', resetNavs);
    
    // å…³é—­å¼¹çª—
    document.querySelector('.close').addEventListener('click', function() {
        document.getElementById('configModal').style.display = 'none';
    });
    
    // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
    window.addEventListener('click', function(event) {
        const modal = document.getElementById('configModal');
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
    
    // é…ç½®é¢æ¿åˆ†é¡µæŒ‰é’®äº‹ä»¶
    document.querySelectorAll('.config-page-btn').forEach((btn, index) => {
        btn.addEventListener('click', function() {
            switchConfigPage(index);
        });
    });
}

document.addEventListener('DOMContentLoaded', function() {
    initEvents();
    loadConfig();
});
</script>
</body>
</html>
